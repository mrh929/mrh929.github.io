

<!DOCTYPE html>
<html lang="cn">
<head prefix="og: http://ogp.me/ns#"><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content="Blog">
    <title>线段树总结 | mrh929&#39;s home</title>

    <!-- Open Graph -->
    <meta name="description" content="&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x603B;&amp;#x7ED3;&amp;#x5F15;&amp;#x5165;&amp;#xFF1A;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7EC4;data[1000000]&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;m&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;(m&amp;lt;=50000)&amp;#xFF0C;&amp;#x64">
<meta property="og:type" content="article">
<meta property="og:title" content="线段树总结">
<meta property="og:url" content="http://mrh1s.top/2018/12/06/e7-ba-bf-e6-ae-b5-e6-a0-91-e6-80-bb-e7-bb-93/index.html">
<meta property="og:site_name" content="mrh929&#39;s home">
<meta property="og:description" content="&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x603B;&amp;#x7ED3;&amp;#x5F15;&amp;#x5165;&amp;#xFF1A;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7EC4;data[1000000]&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;m&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;(m&amp;lt;=50000)&amp;#xFF0C;&amp;#x64">
<meta property="og:locale" content="cn">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">
<meta property="og:updated_time" content="2019-05-03T06:19:59.674Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="线段树总结">
<meta name="twitter:description" content="&amp;#x7EBF;&amp;#x6BB5;&amp;#x6811;&amp;#x603B;&amp;#x7ED3;&amp;#x5F15;&amp;#x5165;&amp;#xFF1A;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7EC4;data[1000000]&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;m&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;(m&amp;lt;=50000)&amp;#xFF0C;&amp;#x64">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==">

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:",
  "image": "",
  "name": "mrh929",
  "url": "http://mrh1s.top"
}
</script>
    <script>
    var algoliaEnabled = false;
    
</script>

    

    
    
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
    
    
    
        <!-- stylesheets list from config.yml -->
        
        <link rel="stylesheet" href="/css/aloha.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/magnific-popup.js/1.1.0/magnific-popup.min.css">
        
    

</head>
<body id="body" style="margin-bottom: 0;" class="pushable">

    <div class="ui top fixed menu">
        <a class="item" id="menu-icon"><i class="sidebar icon"></i></a>
    </div>

    <div id="menu-sidebar" class="ui left vertical sidebar menu">

    <div id="sidebar-top">
        <div class="content">
            <h3>mrh929&#39;s home</h3>
        </div>
    </div>
    <div class="ui container sidebar-card">
    <div class="ui people shape content">
        <div class="active side">
            <div class="ui card">
                <div class="image">
                    <img class="ui medium bordered image" src="/images/avatar.jpg">
                </div>
                <div class="content">
                    <a class="header">mrh929</a>
                    
                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                        
                    </div>

                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

    
    

    

    
    <a href="/index.html" class="item">
        <i class="home icon"></i>
        HOME
    </a>

    

    
</div>

    <div class="pusher body-content">
        <div id="content" class="ui main container">
            <!--<div class="ui one column grid">-->
                <!--<div class="column">-->
                    <!--<div class="ui main container">-->
                        <div id="post-e7-ba-bf-e6-ae-b5-e6-a0-91-e6-80-bb-e7-bb-93" class="ui main container article-type-post">

    

    <div class="ui divided grid">

        <div class="two column row" id="article-content">

            <div class="thirteen wide computer thirteen wide tablet sixteen wide mobile column">
                

<h1 class="ui header">
    
    线段树总结
</h1>



                <div class="article-inner">

                    <div class="article-entry" itemprop="articleBody">
                        
                        <h1 id="&#x7EBF;&#x6BB5;&#x6811;&#x603B;&#x7ED3;"><a href="#&#x7EBF;&#x6BB5;&#x6811;&#x603B;&#x7ED3;" class="headerlink" title="&#x7EBF;&#x6BB5;&#x6811;&#x603B;&#x7ED3;"></a>&#x7EBF;&#x6BB5;&#x6811;&#x603B;&#x7ED3;</h1><p><strong>&#x5F15;&#x5165;&#xFF1A;&#x6709;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;data[1000000]&#xFF0C;&#x5982;&#x679C;&#x6709;m&#x4E2A;&#x64CD;&#x4F5C;(m&lt;=50000)&#xFF0C;&#x64CD;&#x4F5C;&#x5982;&#x4E0B;&#xFF1A;</strong></p>
<ol class="ui list">
<li><strong>&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x6570;&#xFF08;&#x52A0;&#x6216;&#x51CF;&#xFF09;</strong></li>
<li><p><strong>&#x6C42;l&#x5230;r&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x548C;</strong></p>
<p><strong>&#x5BF9;&#x4E8E;&#x901A;&#x5E38;&#x7684;&#x9898;&#x76EE;&#xFF0C;&#x7528;&#x4E00;&#x4E2A;sum[i]&#x6570;&#x7EC4;&#x8BB0;&#x5F55;1~i&#x7684;&#x548C;&#xFF0C;&#x5373;&#x53EF;&#x5C06;&#x4EFB;&#x4F55;&#x7684;&#x533A;&#x95F4;&#x548C;&#x5728;O(1)&#x7684;&#x65F6;&#x95F4;&#x4E4B;&#x5185;&#x6C42;&#x51FA;&#x3002;&#x7136;&#x800C;&#x5BF9;&#x4E8E;&#x64CD;&#x4F5C;&#x4E00;&#xFF0C;&#x663E;&#x7136;&#x5C31;&#x663E;&#x5F97;&#x5F88;&#x8017;&#x65F6;&#x95F4;&#xFF0C;&#x81F3;&#x5C11;&#x4F1A;&#x82B1;&#x8D39;O(n)&#xFF0C;&#x7531;&#x6B64;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8FD9;&#x6837;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x6709;&#x4E00;&#x5B9A;&#x7F3A;&#x9677;&#x7684;&#xFF0C;&#x7531;&#x6B64;&#x7EBF;&#x6BB5;&#x6811;&#x4FBF;&#x4EA7;&#x751F;&#x4E86;&#x3002;</strong>  <strong>&#x7EBF;&#x6BB5;&#x6811;&#x662F;&#x4E00;&#x79CD;</strong><a href="http://baike.baidu.com/view/389453.htm" target="_blank" rel="noopener"><strong>&#x4E8C;&#x53C9;&#x641C;&#x7D22;&#x6811;</strong></a><strong>&#xFF0C;&#x4E0E;</strong><a href="http://baike.baidu.com/view/3861858.htm" target="_blank" rel="noopener"><strong>&#x533A;&#x95F4;&#x6811;</strong></a><strong>&#x76F8;&#x4F3C;&#xFF0C;&#x5B83;&#x5C06;&#x4E00;&#x4E2A;&#x533A;&#x95F4;&#x5212;&#x5206;&#x6210;&#x4E00;&#x4E9B;&#x5355;&#x5143;&#x533A;&#x95F4;&#xFF0C;&#x6BCF;&#x4E2A;&#x5355;&#x5143;&#x533A;&#x95F4;&#x5BF9;&#x5E94;&#x7EBF;&#x6BB5;&#x6811;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x53F6;&#x7ED3;&#x70B9;&#x3002;</strong> <strong>&#x6211;&#x4EEC;&#x4ECE;1~n&#x7684;&#x533A;&#x95F4;&#x5F00;&#x59CB;&#xFF0C;&#x4F9D;&#x6B21;&#x5F80;&#x4E0B;&#x4E8C;&#x5206;&#x52A0;&#x5165;&#x66F4;&#x5C0F;&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x76F4;&#x5230;&#x533A;&#x95F4;&#x957F;&#x5EA6;&#x4E3A;1</strong>  <strong>&#x5982;&#x56FE;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x5DE6;&#x95ED;&#x53F3;&#x5F00;&#x533A;&#x95F4;&#x7C7B;&#x4F3C;&#x4E8E;&#x95ED;&#x533A;&#x95F4;&#xFF0C;&#x8868;&#x793A;&#x7684;&#x5143;&#x7D20;&#x96C6;&#x5408;&#x57FA;&#x672C;&#x76F8;&#x540C;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#xFF0C;&#x7EBF;&#x6BB5;&#x6811;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E8C;&#x53C9;&#x6811;&#xFF0C;&#x4F46;&#x662F;&#x5341;&#x5206;&#x7C7B;&#x4F3C;&#x4E8E;&#x5B8C;&#x5168;&#x4E8C;&#x53C9;&#x6811;&#xFF0C;&#x7531;&#x6B64;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x4E00;&#x822C;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#xFF0C;&#x7528;&#x5B8C;&#x5168;&#x4E8C;&#x53C9;&#x6811;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x3002;</strong>  <strong>&#x64CD;&#x4F5C;1&#x4E2D;&#xFF0C;&#x53EA;&#x80FD;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x4FEE;&#x6539;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x6574;&#x4E2A;&#x533A;&#x95F4;&#xFF0C;&#x8981;&#x6DFB;&#x52A0;n&#x6B21;&#x6570;&#xFF0C;&#x5927;&#x5927;&#x589E;&#x52A0;&#x4E86;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x65F6;&#x95F4;&#x3002;</strong> <strong>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;lazy&#x6570;&#x7EC4;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x5728;&#x904D;&#x5386;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x73B0;&#x9700;&#x8981;&#x5B58;&#x50A8;&#x7684;&#x533A;&#x95F4;&#x5DF2;&#x7ECF;&#x5305;&#x542B;&#x4E86;&#x5F53;&#x524D;&#x904D;&#x5386;&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x6570;&#x503C;&#x901A;&#x8FC7;lazy&#x6682;&#x5B58;&#x5728;&#x6B64;&#x5904;&#xFF0C;&#x76F4;&#x5230;&#x4E0B;&#x4E00;&#x6B21;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x6570;&#x6216;&#x8005;&#x5728;&#x67E5;&#x627E;&#x533A;&#x95F4;&#x548C;&#x65F6;&#xFF0C;&#x518D;&#x8C03;&#x7528;lazy&#xFF0C;&#x5C06;&#x66F4;&#x6DF1;&#x5904;&#x7684;sum&#x503C;&#x66F4;&#x65B0;</strong> <strong>&#x8FD9;&#x6837;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x6DFB;&#x52A0;&#x5143;&#x7D20;&#x7684;&#x901A;&#x7528;&#x505A;&#x6CD5;&#xFF0C;&#x5C06;&#x6240;&#x6709;&#x4FEE;&#x6539;&#x70B9;&#x7684;&#x64CD;&#x4F5C;&#x770B;&#x4F5C;&#x4FEE;&#x6539;&#x957F;&#x5EA6;&#x4E3A;1&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x8FD9;&#x6837;&#x5927;&#x5927;&#x589E;&#x52A0;&#x4E86;&#x7B97;&#x6CD5;&#x7684;&#x666E;&#x9002;&#x6027;</strong>  <strong>&#x66F4;&#x7D27;&#x51D1;&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;</strong> <strong>&#x521A;&#x521A;&#x63D0;&#x5230;&#x7EBF;&#x6BB5;&#x6811;&#x4E0D;&#x5B8C;&#x5168;&#x5C5E;&#x4E8E;&#x5B8C;&#x5168;&#x4E8C;&#x53C9;&#x6811;&#xFF0C;&#x6240;&#x4EE5;&#x7528;&#x5806;&#x7684;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#x4F1A;&#x5F15;&#x8D77;&#x5185;&#x5B58;&#x7684;&#x6D6A;&#x8D39;&#xFF0C;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x4E00;&#x5B9A;&#x8282;&#x7701;&#x3002;</strong> <strong>&#x5BF9;&#x4E8E;&#x8282;&#x70B9;&#x533A;&#x95F4;&#x4E3A;[l,r)&#x7684;&#x7ED3;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x5730;&#x5740;&#x6620;&#x5C04;&#x5230;(l+r-1)|( (r-1)!=1)&#xFF0C;&#x5176;&#x4E2D;(r-l)!=1&#x7528;&#x6765;&#x5224;&#x65AD;r&#x4E0E;l&#x5DEE;&#x503C;&#x662F;&#x5426;&#x4E3A;1&#x3002;&#x53EF;&#x5C06;&#x4F7F;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#x7CBE;&#x786E;&#x65E0;&#x8BEF;&#x5730;&#x6620;&#x5C04;&#x5230;[0,2n-2]&#x4E2D;</strong>  <strong>&#x5173;&#x4E8E;&#x5F00;&#x6570;&#x7EC4;&#x7684;tips&#xFF1A;</strong></p>
</li>
<li><p><strong>&#x5BF9;&#x4E8E;&#x5806;&#x7684;&#x5F00;&#x6CD5;&#xFF0C;&#x6570;&#x7EC4;&#x5927;&#x5C0F;&#x81F3;&#x5C11;4n</strong></p>
</li>
<li><strong>&#x5BF9;&#x4E8E;&#x7D27;&#x51D1;&#x7684;&#x50A8;&#x5B58;&#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x9002;&#x5F53;&#x5F00;2n</strong></li>
</ol>
<p><strong>Hdu 1166 &#x654C;&#x5175;&#x5E03;&#x9635;</strong> <strong>Problem Description</strong> C&#x56FD;&#x7684;&#x6B7B;&#x5BF9;&#x5934;A&#x56FD;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#x519B;&#x4E8B;&#x6F14;&#x4E60;&#xFF0C;&#x6240;&#x4EE5;C&#x56FD;&#x95F4;&#x8C0D;&#x5934;&#x5B50;Derek&#x548C;&#x4ED6;&#x624B;&#x4E0B;Tidy&#x53C8;&#x5F00;&#x59CB;&#x5FD9;&#x4E4E;&#x4E86;&#x3002;A&#x56FD;&#x5728;&#x6D77;&#x5CB8;&#x7EBF;&#x6CBF;&#x76F4;&#x7EBF;&#x5E03;&#x7F6E;&#x4E86;N&#x4E2A;&#x5DE5;&#x5175;&#x8425;&#x5730;,Derek&#x548C;Tidy&#x7684;&#x4EFB;&#x52A1;&#x5C31;&#x662F;&#x8981;&#x76D1;&#x89C6;&#x8FD9;&#x4E9B;&#x5DE5;&#x5175;&#x8425;&#x5730;&#x7684;&#x6D3B;&#x52A8;&#x60C5;&#x51B5;&#x3002;&#x7531;&#x4E8E;&#x91C7;&#x53D6;&#x4E86;&#x67D0;&#x79CD;&#x5148;&#x8FDB;&#x7684;&#x76D1;&#x6D4B;&#x624B;&#x6BB5;&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x4E2A;&#x5DE5;&#x5175;&#x8425;&#x5730;&#x7684;&#x4EBA;&#x6570;C&#x56FD;&#x90FD;&#x638C;&#x63E1;&#x7684;&#x4E00;&#x6E05;&#x4E8C;&#x695A;,&#x6BCF;&#x4E2A;&#x5DE5;&#x5175;&#x8425;&#x5730;&#x7684;&#x4EBA;&#x6570;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x53D8;&#x52A8;&#xFF0C;&#x53EF;&#x80FD;&#x589E;&#x52A0;&#x6216;&#x51CF;&#x5C11;&#x82E5;&#x5E72;&#x4EBA;&#x624B;,&#x4F46;&#x8FD9;&#x4E9B;&#x90FD;&#x9003;&#x4E0D;&#x8FC7;C&#x56FD;&#x7684;&#x76D1;&#x89C6;&#x3002; &#x4E2D;&#x592E;&#x60C5;&#x62A5;&#x5C40;&#x8981;&#x7814;&#x7A76;&#x654C;&#x4EBA;&#x7A76;&#x7ADF;&#x6F14;&#x4E60;&#x4EC0;&#x4E48;&#x6218;&#x672F;,&#x6240;&#x4EE5;Tidy&#x8981;&#x968F;&#x65F6;&#x5411;Derek&#x6C47;&#x62A5;&#x67D0;&#x4E00;&#x6BB5;&#x8FDE;&#x7EED;&#x7684;&#x5DE5;&#x5175;&#x8425;&#x5730;&#x4E00;&#x5171;&#x6709;&#x591A;&#x5C11;&#x4EBA;,&#x4F8B;&#x5982;Derek&#x95EE;:&#x201C;Tidy,&#x9A6C;&#x4E0A;&#x6C47;&#x62A5;&#x7B2C;3&#x4E2A;&#x8425;&#x5730;&#x5230;&#x7B2C;10&#x4E2A;&#x8425;&#x5730;&#x5171;&#x6709;&#x591A;&#x5C11;&#x4EBA;!&#x201D;Tidy&#x5C31;&#x8981;&#x9A6C;&#x4E0A;&#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#x8FD9;&#x4E00;&#x6BB5;&#x7684;&#x603B;&#x4EBA;&#x6570;&#x5E76;&#x6C47;&#x62A5;&#x3002;&#x4F46;&#x654C;&#x5175;&#x8425;&#x5730;&#x7684;&#x4EBA;&#x6570;&#x7ECF;&#x5E38;&#x53D8;&#x52A8;&#xFF0C;&#x800C;Derek&#x6BCF;&#x6B21;&#x8BE2;&#x95EE;&#x7684;&#x6BB5;&#x90FD;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x6240;&#x4EE5;Tidy&#x4E0D;&#x5F97;&#x4E0D;&#x6BCF;&#x6B21;&#x90FD;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x8425;&#x5730;&#x7684;&#x53BB;&#x6570;&#xFF0C;&#x5F88;&#x5FEB;&#x5C31;&#x7CBE;&#x75B2;&#x529B;&#x5C3D;&#x4E86;&#xFF0C;Derek&#x5BF9;Tidy&#x7684;&#x8BA1;&#x7B97;&#x901F;&#x5EA6;&#x8D8A;&#x6765;&#x8D8A;&#x4E0D;&#x6EE1;:&#x201D;&#x4F60;&#x4E2A;&#x6B7B;&#x80A5;&#x4ED4;&#xFF0C;&#x7B97;&#x5F97;&#x8FD9;&#x4E48;&#x6162;&#xFF0C;&#x6211;&#x7092;&#x4F60;&#x9C7F;&#x9C7C;!&#x201D;Tidy&#x60F3;&#xFF1A;&#x201C;&#x4F60;&#x81EA;&#x5DF1;&#x6765;&#x7B97;&#x7B97;&#x770B;&#xFF0C;&#x8FD9;&#x53EF;&#x771F;&#x662F;&#x4E00;&#x9879;&#x7D2F;&#x4EBA;&#x7684;&#x5DE5;&#x4F5C;!&#x6211;&#x6068;&#x4E0D;&#x5F97;&#x4F60;&#x7092;&#x6211;&#x9C7F;&#x9C7C;&#x5462;!&#x201D;&#x65E0;&#x5948;&#x4E4B;&#x4E0B;&#xFF0C;Tidy&#x53EA;&#x597D;&#x6253;&#x7535;&#x8BDD;&#x5411;&#x8BA1;&#x7B97;&#x673A;&#x4E13;&#x5BB6;Windbreaker&#x6C42;&#x6551;,Windbreaker&#x8BF4;&#xFF1A;&#x201C;&#x6B7B;&#x80A5;&#x4ED4;&#xFF0C;&#x53EB;&#x4F60;&#x5E73;&#x65F6;&#x505A;&#x591A;&#x70B9;acm&#x9898;&#x548C;&#x770B;&#x591A;&#x70B9;&#x7B97;&#x6CD5;&#x4E66;&#xFF0C;&#x73B0;&#x5728;&#x5C1D;&#x5230;&#x82E6;&#x679C;&#x4E86;&#x5427;!&#x201D;Tidy&#x8BF4;&#xFF1A;&#x201D;&#x6211;&#x77E5;&#x9519;&#x4E86;&#x3002;&#x3002;&#x3002;&#x201D;&#x4F46;Windbreaker&#x5DF2;&#x7ECF;&#x6302;&#x6389;&#x7535;&#x8BDD;&#x4E86;&#x3002;Tidy&#x5F88;&#x82E6;&#x607C;&#xFF0C;&#x8FD9;&#x4E48;&#x7B97;&#x4ED6;&#x771F;&#x7684;&#x4F1A;&#x5D29;&#x6E83;&#x7684;&#xFF0C;&#x806A;&#x660E;&#x7684;&#x8BFB;&#x8005;&#xFF0C;&#x4F60;&#x80FD;&#x5199;&#x4E2A;&#x7A0B;&#x5E8F;&#x5E2E;&#x4ED6;&#x5B8C;&#x6210;&#x8FD9;&#x9879;&#x5DE5;&#x4F5C;&#x5417;&#xFF1F;&#x4E0D;&#x8FC7;&#x5982;&#x679C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x6548;&#x7387;&#x4E0D;&#x591F;&#x9AD8;&#x7684;&#x8BDD;&#xFF0C;Tidy&#x8FD8;&#x662F;&#x4F1A;&#x53D7;&#x5230;Derek&#x7684;&#x8D23;&#x9A82;&#x7684;.   <strong>Input</strong> &#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;T&#xFF0C;&#x8868;&#x793A;&#x6709;T&#x7EC4;&#x6570;&#x636E;&#x3002; &#x6BCF;&#x7EC4;&#x6570;&#x636E;&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#xFF08;N&lt;=50000&#xFF09;,&#x8868;&#x793A;&#x654C;&#x4EBA;&#x6709;N&#x4E2A;&#x5DE5;&#x5175;&#x8425;&#x5730;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6709;N&#x4E2A;&#x6B63;&#x6574;&#x6570;,&#x7B2C;i&#x4E2A;&#x6B63;&#x6574;&#x6570;ai&#x4EE3;&#x8868;&#x7B2C;i&#x4E2A;&#x5DE5;&#x5175;&#x8425;&#x5730;&#x91CC;&#x5F00;&#x59CB;&#x65F6;&#x6709;ai&#x4E2A;&#x4EBA;&#xFF08;1&lt;=ai&lt;=50&#xFF09;&#x3002; &#x63A5;&#x4E0B;&#x6765;&#x6BCF;&#x884C;&#x6709;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#xFF0C;&#x547D;&#x4EE4;&#x6709;4&#x79CD;&#x5F62;&#x5F0F;&#xFF1A; (1) Add i j,i&#x548C;j&#x4E3A;&#x6B63;&#x6574;&#x6570;,&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x8425;&#x5730;&#x589E;&#x52A0;j&#x4E2A;&#x4EBA;&#xFF08;j&#x4E0D;&#x8D85;&#x8FC7;30&#xFF09; (2)Sub i j ,i&#x548C;j&#x4E3A;&#x6B63;&#x6574;&#x6570;,&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x8425;&#x5730;&#x51CF;&#x5C11;j&#x4E2A;&#x4EBA;&#xFF08;j&#x4E0D;&#x8D85;&#x8FC7;30&#xFF09;; (3)Query i j ,i&#x548C;j&#x4E3A;&#x6B63;&#x6574;&#x6570;,i&lt;=j&#xFF0C;&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x7B2C;i&#x5230;&#x7B2C;j&#x4E2A;&#x8425;&#x5730;&#x7684;&#x603B;&#x4EBA;&#x6570;; (4)End &#x8868;&#x793A;&#x7ED3;&#x675F;&#xFF0C;&#x8FD9;&#x6761;&#x547D;&#x4EE4;&#x5728;&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#x6700;&#x540E;&#x51FA;&#x73B0;; &#x6BCF;&#x7EC4;&#x6570;&#x636E;&#x6700;&#x591A;&#x6709;40000&#x6761;&#x547D;&#x4EE4;   <strong>Output</strong> &#x5BF9;&#x7B2C;i&#x7EC4;&#x6570;&#x636E;,&#x9996;&#x5148;&#x8F93;&#x51FA;&#x201C;Case i:&#x201D;&#x548C;&#x56DE;&#x8F66;, &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;Query&#x8BE2;&#x95EE;&#xFF0C;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5E76;&#x56DE;&#x8F66;,&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x7684;&#x6BB5;&#x4E2D;&#x7684;&#x603B;&#x4EBA;&#x6570;,&#x8FD9;&#x4E2A;&#x6570;&#x4FDD;&#x6301;&#x5728;int&#x4EE5;&#x5185;&#x3002;   <strong>Sample Input</strong> 1 10 12 3 4 5 6 7 8 9 10 Query1 3 Add3 6 Query2 7 Sub10 2 Add6 3 Query3 10 End   <strong>Sample Output</strong> Case1: 6 33 59  </p>
<pre><code>#include&lt;cstdio&gt;
#define MAX 1000020
#define lson l,m,rt&lt;&lt;1 //&#x5DE6;&#x513F;&#x5B50; 
#define rson m+1,r,rt&lt;&lt;1|1 //&#x53F3;&#x513F;&#x5B50; 
//&#x95ED;&#x533A;&#x95F4;&#x7EBF;&#x6BB5;&#x6811; 
int sum[MAX];
char str[10];
void PushUP(int rt) {
    sum[rt]=sum[rt&lt;&lt;1]+sum[rt&lt;&lt;1|1];
}

void Revise(int p,int data,int l,int r,int rt){
    if(l==r){//&#x533A;&#x95F4;&#x957F;&#x5EA6;&#x4E3A;1 
        sum[rt]+=data;
        return;
    }
    int m=(l+r)&gt;&gt;1;//&#x53D6;&#x4E2D;&#x70B9; 
    if(p&lt;=m) Revise(p,data,lson);//&#x5411;&#x5DE6;&#x9012;&#x5F52;&#x7EBF;&#x6BB5;&#x6811; 
    else Revise(p,data,rson);//&#x5411;&#x53F3;&#x9012;&#x5F52;&#x7EBF;&#x6BB5;&#x6811; 
    PushUP(rt);//&#x66F4;&#x65B0;&#x6839;&#x8282;&#x70B9;&#x7684;sum 
}

int Query(int L,int R,int l,int r,int rt){//[L,R]&#x4E3A;&#x67E5;&#x627E;&#x7684;&#x533A;&#x95F4; &#xFF0C;[l,r]&#x4E3A;&#x5F53;&#x524D;&#x904D;&#x5386;&#x7684;&#x533A;&#x95F4; 
    if(L&lt;=l&amp;&amp;R&gt;=r) //&#x67E5;&#x627E;&#x7684;&#x533A;&#x95F4;&#x5305;&#x542B;&#x904D;&#x5386;&#x7684;&#x533A;&#x95F4;
        return sum[rt];
    int m=(l+r)&gt;&gt;1,tot=0;
    if(L&lt;=m) tot+=Query(L,R,lson);
    if(R&gt;m) tot+=Query(L,R,rson);
    return tot;
}

void build(int l,int r,int rt) {
    if (l==r){
        scanf(&quot;%d&quot;,&amp;sum[rt]);
        return;
    }
    int m=(l+r)&gt;&gt;1;
    build(lson);
    build(rson);
    PushUP(rt);//&#x66F4;&#x65B0;&#x6839;&#x8282;&#x70B9;&#x7684;sum 
}

int main(){
//    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    int t,n,a,b;
    scanf(&quot;%d&quot;,&amp;t);
    for(int i=1;i&lt;=t;i++){
        scanf(&quot;%d&quot;,&amp;n);
/*        for(int j=1;j&lt;=n;j++){
            scanf(&quot;%d&quot;,&amp;a);
            Revise(j,a,1,n,1);
        }*/
        build(1,n,1);
        printf(&quot;Case %d:\n&quot;,i);
        while(scanf(&quot;%s&quot;,str)!=EOF&amp;&amp;str[0]!=&apos;E&apos;){
            scanf(&quot;%d%d&quot;,&amp;a,&amp;b);
            if(str[0]==&apos;A&apos;) Revise(a,b,1,n,1);
            else if(str[0]==&apos;S&apos;) Revise(a,-b,1,n,1);
            else printf(&quot;%d\n&quot;,Query(a,b,1,n,1));
        }
    }

    return 0;
}
</code></pre><p><a class="magnific-img" href="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt title="&#x70B9;&#x51FB;&#x5E76;&#x62D6;&#x62FD;&#x4EE5;&#x79FB;&#x52A8;" class="ui centered image"></a></p>
<p>  <strong>hdu 1754   I Hate It</strong> <strong>Problem Description</strong> &#x5F88;&#x591A;&#x5B66;&#x6821;&#x6D41;&#x884C;&#x4E00;&#x79CD;&#x6BD4;&#x8F83;&#x7684;&#x4E60;&#x60EF;&#x3002;&#x8001;&#x5E08;&#x4EEC;&#x5F88;&#x559C;&#x6B22;&#x8BE2;&#x95EE;&#xFF0C;&#x4ECE;&#x67D0;&#x67D0;&#x5230;&#x67D0;&#x67D0;&#x5F53;&#x4E2D;&#xFF0C;&#x5206;&#x6570;&#x6700;&#x9AD8;&#x7684;&#x662F;&#x591A;&#x5C11;&#x3002; &#x8FD9;&#x8BA9;&#x5F88;&#x591A;&#x5B66;&#x751F;&#x5F88;&#x53CD;&#x611F;&#x3002;   &#x4E0D;&#x7BA1;&#x4F60;&#x559C;&#x4E0D;&#x559C;&#x6B22;&#xFF0C;&#x73B0;&#x5728;&#x9700;&#x8981;&#x4F60;&#x505A;&#x7684;&#x662F;&#xFF0C;&#x5C31;&#x662F;&#x6309;&#x7167;&#x8001;&#x5E08;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x5199;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x6A21;&#x62DF;&#x8001;&#x5E08;&#x7684;&#x8BE2;&#x95EE;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x8001;&#x5E08;&#x6709;&#x65F6;&#x5019;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x67D0;&#x4F4D;&#x540C;&#x5B66;&#x7684;&#x6210;&#x7EE9;&#x3002;   <strong>Input</strong> &#x672C;&#x9898;&#x76EE;&#x5305;&#x542B;&#x591A;&#x7EC4;&#x6D4B;&#x8BD5;&#xFF0C;&#x8BF7;&#x5904;&#x7406;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#x3002; &#x5728;&#x6BCF;&#x4E2A;&#x6D4B;&#x8BD5;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x6709;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570; N &#x548C; M ( 0&lt;N&lt;=200000,0&lt;M&lt;5000 )&#xFF0C;&#x5206;&#x522B;&#x4EE3;&#x8868;&#x5B66;&#x751F;&#x7684;&#x6570;&#x76EE;&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x76EE;&#x3002; &#x5B66;&#x751F;ID&#x7F16;&#x53F7;&#x5206;&#x522B;&#x4ECE;1&#x7F16;&#x5230;N&#x3002; &#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4EE3;&#x8868;&#x8FD9;N&#x4E2A;&#x5B66;&#x751F;&#x7684;&#x521D;&#x59CB;&#x6210;&#x7EE9;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6570;&#x4EE3;&#x8868;ID&#x4E3A;i&#x7684;&#x5B66;&#x751F;&#x7684;&#x6210;&#x7EE9;&#x3002; &#x63A5;&#x4E0B;&#x6765;&#x6709;M&#x884C;&#x3002;&#x6BCF;&#x4E00;&#x884C;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x7B26; C (&#x53EA;&#x53D6;&#x2019;Q&#x2019;&#x6216;&#x2019;U&#x2019;) &#xFF0C;&#x548C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;A&#xFF0C;B&#x3002; &#x5F53;C&#x4E3A;&#x2019;Q&#x2019;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8868;&#x793A;&#x8FD9;&#x662F;&#x4E00;&#x6761;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x8BE2;&#x95EE;ID&#x4ECE;A&#x5230;B(&#x5305;&#x62EC;A,B)&#x7684;&#x5B66;&#x751F;&#x5F53;&#x4E2D;&#xFF0C;&#x6210;&#x7EE9;&#x6700;&#x9AD8;&#x7684;&#x662F;&#x591A;&#x5C11;&#x3002; &#x5F53;C&#x4E3A;&#x2019;U&#x2019;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8868;&#x793A;&#x8FD9;&#x662F;&#x4E00;&#x6761;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#xFF0C;&#x8981;&#x6C42;&#x628A;ID&#x4E3A;A&#x7684;&#x5B66;&#x751F;&#x7684;&#x6210;&#x7EE9;&#x66F4;&#x6539;&#x4E3A;B&#x3002;   <strong>Output</strong> &#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x6B21;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#xFF0C;&#x5728;&#x4E00;&#x884C;&#x91CC;&#x9762;&#x8F93;&#x51FA;&#x6700;&#x9AD8;&#x6210;&#x7EE9;&#x3002;   <strong>Sample Input</strong> 5 6 1 2 3 4 5 Q 1 5 U 3 6 Q 3 4 Q 4 5 U 2 9 Q 1 5   <strong>Sample Output</strong> 5 6 5 9 <strong>Hint</strong> Huge input,the C function scanf() will workbetter than cin <strong>&#x7EBF;&#x6BB5;&#x6811;&#x7A0D;&#x5FAE;&#x53D8;&#x4E86;&#x4E00;&#x70B9;&#x70B9;&#x578B;&#xFF0C;&#x5728;&#x66F4;&#x65B0;&#x6BCF;&#x4E2A;&#x7ED3;&#x70B9;&#x7684;&#x65F6;&#x5019;&#x53D6;&#x6700;&#x5927;&#x503C;&#x800C;&#x4E0D;&#x53D6;&#x548C;</strong>  </p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#define lson l,m,rt&lt;&lt;1
#define rson m+1,r,rt&lt;&lt;1|1

using namespace std;
const int MAX=1000000;
int sum[MAX];
void PushUP(int rt){
    sum[rt]=max(sum[rt&lt;&lt;1],sum[rt&lt;&lt;1|1]);
}

void Build(int l,int r,int rt){
    if(l==r){
        scanf(&quot;%d&quot;,&amp;sum[rt]);
        return;
    }
    int m=(l+r)&gt;&gt;1;
    Build(lson);
    Build(rson);
    PushUP(rt);
}

int Query(int L,int R,int l,int r,int rt){
    if(L&lt;=l&amp;&amp;R&gt;=r) return sum[rt];
    int m=(l+r)&gt;&gt;1,maxx=-1;
    if(L&lt;=m) maxx=max(maxx,Query(L,R,lson));
    if(R&gt;=m+1) maxx=max(maxx,Query(L,R,rson));
    return maxx;
}

void Revise(int p,int data,int l,int r,int rt){
    if(l==r){
        sum[rt]=data;
        return;
    }
    int m=(l+r)&gt;&gt;1;
    if(p&lt;=m) Revise(p,data,lson);
    else Revise(p,data,rson);
    PushUP(rt);
}

int main(){
//    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    int n,m,a,b; char c;
    while(scanf(&quot;%d%d&quot;,&amp;n,&amp;m)!=EOF){
        memset(sum,0,sizeof(sum));
        Build(1,n,1);
        for(int i=1;i&lt;=m;i++){
            getchar();
            c=getchar();
            scanf(&quot;%d%d&quot;,&amp;a,&amp;b);
            if(c==&apos;U&apos;) Revise(a,b,1,n,1);
            else printf(&quot;%d\n&quot;,Query(a,b,1,n,1));
        }
    }
}
</code></pre><p><a class="magnific-img" href="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt title="&#x70B9;&#x51FB;&#x5E76;&#x62D6;&#x62FD;&#x4EE5;&#x79FB;&#x52A8;" class="ui centered image"></a></p>
<p>  <strong>poj 2299</strong> <strong>&#x9898;&#x610F;&#xFF1A;</strong> &#x6C42;&#x9006;&#x5E8F;&#x5BF9;</p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#define lson l,m,rt&lt;&lt;1
#define rson m+1,r,rt&lt;&lt;1|1
#define MAX 500020
using namespace std;
int data[MAX],t[MAX],sum[MAX&lt;&lt;2];
bool flag[MAX];

void PushUP(int rt){
    sum[rt]=sum[rt&lt;&lt;1]+sum[rt&lt;&lt;1|1];
}

int Find(int s,int e,int aim){
    while(s&lt;=e){
        int mid=(s+e)&gt;&gt;1;
        if(t[mid]==aim){
            while(t[mid-1]==t[mid]){
                flag[mid]=-1;
                mid--;
            }
            return mid;
        }
        else if(t[mid]&gt;aim) e=mid-1;
        else s=mid+1;
    }
}

void Revise(int p,int l,int r,int rt){
    if(l==r){
        sum[rt]+=1;
        return;
    }
    int m=(l+r)&gt;&gt;1;
    if(p&lt;=m) Revise(p,lson);
    else Revise(p,rson);
    PushUP(rt);
}

long long View(int L,int R,int l,int r,int rt){
    if(L&lt;=l&amp;&amp;R&gt;=r) return sum[rt];
    int m=(l+r)&gt;&gt;1;
    long long tot=0;
    if(L&lt;=m) tot+=View(L,R,lson);
    if(R&gt;=m+1) tot+=View(L,R,rson);
    return tot;
}

int main(){
//    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    int n; long long ans;
    while(scanf(&quot;%d&quot;,&amp;n)&amp;&amp;n){
        memset(sum,0,sizeof(sum));
        ans=0;
        for(int i=1;i&lt;=n;i++){
            scanf(&quot;%d&quot;,&amp;data[i]);
            t[i]=data[i];
        }
        sort(t+1,t+1+n);
        for(int i=1;i&lt;=n;i++){
            int f=Find(1,n,data[i]);
            ans+=View(f+1,n,1,n,1);
            Revise(f,1,n,1);    
        }
        printf(&quot;%lld\n&quot;,ans);
    }



    return 0;
}
</code></pre><p><a class="magnific-img" href="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt title="&#x70B9;&#x51FB;&#x5E76;&#x62D6;&#x62FD;&#x4EE5;&#x79FB;&#x52A8;" class="ui centered image"></a></p>
<p><strong>POJ3468</strong> <strong>Description</strong> You have N integers, A1, A2, &#x2026; , AN. Youneed to deal with two kinds of operations. One type of operation is to add somegiven number to each number in a given interval. The other is to ask for thesum of numbers in a given interval. <strong>Input</strong> The first line contains two numbers N andQ. 1 &#x2264; N,Q &#x2264; 100000. The second line contains N numbers, theinitial values of A1, A2, &#x2026; , AN. -1000000000 &#x2264; Ai &#x2264; 1000000000. Each of the next Q lines represents anoperation. &#x201C;C a b c&#x201D; means adding c to eachof Aa, Aa+1, &#x2026; , Ab. -10000 &#x2264; c &#x2264; 10000. &#x201C;Q a b&#x201D; means querying the sum ofAa, Aa+1, &#x2026; , Ab. <strong>Output</strong> You need to answer all Q commands in order.One answer in a line. <strong>Sample Input</strong> 10 5 1 2 3 4 5 6 7 8 9 10 Q 4 4 Q 1 10 Q 2 4 C 3 6 3 Q 2 4 <strong>Sample Output</strong> 4 55 9 15 <strong>&#x9898;&#x610F;&#xFF1A;</strong> &#x7ED9;&#x4F60;N&#x4E2A;&#x6570;&#xFF0C;Q&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x64CD;&#x4F5C;&#x6709;&#x4E24;&#x79CD;&#xFF0C;&#x2018;Q a b &#x2019;&#x662F;&#x8BE2;&#x95EE;a~b&#x8FD9;&#x6BB5;&#x6570;&#x7684;&#x548C;&#xFF0C;&#x2018;Ca b c&#x2019;&#x662F;&#x628A;a~b&#x8FD9;&#x6BB5;&#x6570;&#x90FD;&#x52A0;&#x4E0A;c&#x3002;</p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#define lson l,m,rt&lt;&lt;1
#define rson m+1,r,rt&lt;&lt;1|1
using namespace std;
const int MAX=100020;
long long data[MAX],sum[MAX&lt;&lt;2],lazy[MAX&lt;&lt;2];

void PushUp(int rt){
    sum[rt]=sum[rt&lt;&lt;1]+sum[rt&lt;&lt;1|1];
}

void PushDown(int rt,int m){
    if(lazy[rt]){//&#x5982;&#x679C;lazy&#x5B58;&#x5728; 
        lazy[rt&lt;&lt;1]+=lazy[rt];//&#x52A0;lazy&#x503C; 
        lazy[rt&lt;&lt;1|1]+=lazy[rt];
        sum[rt&lt;&lt;1]+=(m-(m&gt;&gt;1))*lazy[rt];//&#x5DE6;&#x513F;&#x5B50;&#x6240;&#x5305;&#x542B;&#x7684;&#x6570;
        sum[rt&lt;&lt;1|1]+=(m&gt;&gt;1)*lazy[rt];//&#x53F3;&#x513F;&#x5B50;&#x6240;&#x5305;&#x542B;&#x7684;&#x6570;
        lazy[rt]=0; 
    }
}

void Build(int l,int r,int rt){
    if(l==r){
        scanf(&quot;%lld&quot;,&amp;sum[rt]);
        return;
    }
    int m=(l+r)&gt;&gt;1;
    Build(lson);
    Build(rson);
    PushUp(rt);
}

void Revise(int L,int R,int data,int l,int r,int rt){
    if(l&gt;=L&amp;&amp;r&lt;=R){
        lazy[rt]+=data;
        sum[rt]+=data*(r-l+1);
        return;
    }
    PushDown(rt,r-l+1);
    int m=(l+r)&gt;&gt;1;
    if(L&lt;=m) Revise(L,R,data,lson);
    if(R&gt;=m+1) Revise(L,R,data,rson);
    PushUp(rt);
}

long long View(int L,int R,int l,int r,int rt){
    if(l&gt;=L&amp;&amp;r&lt;=R) return sum[rt];
    PushDown(rt,r-l+1);
    int m=(l+r)&gt;&gt;1;
    long long tot=0;
    if(L&lt;=m) tot+=View(L,R,lson);
    if(R&gt;m) tot+=View(L,R,rson);
    return tot;    
}

int main(){
//    freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    int n,q,a,b,c;
    scanf(&quot;%d%d&quot;,&amp;n,&amp;q);
    Build(1,n,1);
    for(int i=1;i&lt;=q;i++){
        getchar();
        if(getchar()==&apos;C&apos;){
            scanf(&quot;%d%d%d&quot;,&amp;a,&amp;b,&amp;c);
            Revise(a,b,c,1,n,1);
        }else{
            scanf(&quot;%d%d&quot;,&amp;a,&amp;b);
            printf(&quot;%lld\n&quot;,View(a,b,1,n,1));
        }
    }



    return 0;
}
</code></pre><p><a class="magnific-img" href="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt title="&#x70B9;&#x51FB;&#x5E76;&#x62D6;&#x62FD;&#x4EE5;&#x79FB;&#x52A8;" class="ui centered image"></a></p>

                        
                    </div>

                    
                    
                    

                    <div class="description post-description">
    <span class="post-description-item">
        <time datetime="2018-12-06T15:46:09.000Z" itemprop="datePublished">2018-12-06</time>

    </span>
    <span class="post-description-item">
        
    </span>
</div>

                </div>
                
                <div id="pagination" class="nav-web ui text container pagination">

    <div class="ui stackable two column divided grid container">
        <div class="row">
            <div class="column nav-left">
                

                <a href="/2018/12/06/e6-a0-91-e7-8a-b6-e6-95-b0-e7-bb-84-e6-80-bb-e7-bb-93/" class="ui tiny button">

                    <i class="angle left icon"></i>
                    
                    树状数组总结
                    

                </a>

                
            </div>
            <div class="column nav-right">
                

                <a href="/2018/12/06/e5-ad-97-e5-85-b8-e6-a0-91-e6-80-bb-e7-bb-93/" class="ui tiny button">
                    
                    字典树总结
                    
                    <i class="angle right icon"></i></a>
                
            </div>
        </div>
    </div>

</div>
                
            </div>

            
            <div class="three wide computer three wide tablet column">

                <div class="ui sticky article-toc" id="article-toc">
                    <!-- toc -->
                    <ol class="ui ordered list"><li><a href="#线段树总结"><span>线段树总结</span></a></li></ol>
                </div>

            </div>
            

        </div>
    </div>
</div>


                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <div class="ui inverted section divider"></div>
        &copy; 2019 <a href="/">mrh929</a>,
        Powered by <a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank">Aloha</a> and <a href="http://hexo.io/" target="_blank">Hexo</a>.
    </div>
</div>

    </div>




<!-- scripts list from theme config.yml -->

<script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>

<script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch/3.18.1/algoliasearch.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch-helper-js/2.13.0/algoliasearch.helper.min.js"></script>

<script src="/js/semantic-ui-algolia.js"></script>

<script src="/js/aloha-events.js"></script>



</body>
</html>
