<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://mrh1s.top').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="RCTF_babyre1rctf_babyre1 思路以下是与输入相关的指令 main__int64 __fastcall main(__int64 a1, char **a2, char **a3)&amp;#123;  unsigned __int64 *in; // rdx  int v4; // ecx  unsigned int v5; // eax  unsigned __int64 v6;">
<meta name="keywords" content="RE_Static,xtea,crc16">
<meta property="og:type" content="article">
<meta property="og:title" content="rctf_babyre1">
<meta property="og:url" content="https://mrh1s.top/posts/122a7c75/index.html">
<meta property="og:site_name" content="mrh929&#39;s home">
<meta property="og:description" content="RCTF_babyre1rctf_babyre1 思路以下是与输入相关的指令 main__int64 __fastcall main(__int64 a1, char **a2, char **a3)&amp;#123;  unsigned __int64 *in; // rdx  int v4; // ecx  unsigned int v5; // eax  unsigned __int64 v6;">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-05-21T12:51:31.761Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rctf_babyre1">
<meta name="twitter:description" content="RCTF_babyre1rctf_babyre1 思路以下是与输入相关的指令 main__int64 __fastcall main(__int64 a1, char **a2, char **a3)&amp;#123;  unsigned __int64 *in; // rdx  int v4; // ecx  unsigned int v5; // eax  unsigned __int64 v6;">

<link rel="canonical" href="https://mrh1s.top/posts/122a7c75/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>rctf_babyre1 | mrh929's home</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mrh929's home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/_posts/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/122a7c75/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          rctf_babyre1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-21 00:49:39 / Modified: 20:51:31" itemprop="dateCreated datePublished" datetime="2019-05-21T00:49:39+08:00">2019-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/" itemprop="url" rel="index">
                    <span itemprop="name">write-up</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/rctf-20190518/" itemprop="url" rel="index">
                    <span itemprop="name">rctf-20190518</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="RCTF-babyre1"><a href="#RCTF-babyre1" class="headerlink" title="RCTF_babyre1"></a>RCTF_babyre1</h1><p><a href="\uploads\rctf_babyre1.7z">rctf_babyre1</a></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>以下是与输入相关的指令</p>
<h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 *in; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// rbx</span></span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [rsp+4h] [rbp-124h]</span></span><br><span class="line">  <span class="keyword">void</span> *ptr; <span class="comment">// [rsp+8h] [rbp-120h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 str; <span class="comment">// [rsp+10h] [rbp-118h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+118h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0L</span>L);</span><br><span class="line">  ptr = <span class="number">0L</span>L;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;str, <span class="number">0</span>, <span class="number">0x100</span>uLL);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Input right flag you can got 'Bingo!' :"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%31s"</span>, &amp;str);                 <span class="comment">// 输入为16位</span></span><br><span class="line">  in = &amp;str;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *(_DWORD *)in;</span><br><span class="line">    in = (<span class="keyword">unsigned</span> __int64 *)((<span class="keyword">char</span> *)in + <span class="number">4</span>);</span><br><span class="line">    v5 = ~v4 &amp; (v4 - <span class="number">0x1010101</span>) &amp; <span class="number">0x80808080</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( !v5 );</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">unsigned</span> __int16)~(_WORD)v4 &amp; (<span class="keyword">unsigned</span> __int16)(v4 - <span class="number">0x101</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">    v5 &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">unsigned</span> __int16)~(_WORD)v4 &amp; (<span class="keyword">unsigned</span> __int16)(v4 - <span class="number">0x101</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">    in = (<span class="keyword">unsigned</span> __int64 *)((<span class="keyword">char</span> *)in + <span class="number">2</span>);</span><br><span class="line">  v6 = (<span class="keyword">char</span> *)in - __CFADD__((_BYTE)v5, (_BYTE)v5) - <span class="number">3</span> - (<span class="keyword">char</span> *)&amp;str;</span><br><span class="line">  <span class="keyword">if</span> ( v6 &gt; <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"input is too long!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v6 == <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = change_into_number((<span class="keyword">unsigned</span> __int64)&amp;str, <span class="number">16</span>, &amp;ptr);<span class="comment">// 这个程序就是把输入的内容（十六进制）转换成了程序可读的数字</span></span><br><span class="line">    <span class="keyword">if</span> ( v7</span><br><span class="line">      &amp;&amp; (v8 = xtea_keychanged(ptr, v7, (__int64)&amp;unk_55883B7B0010, <span class="number">16</span>, &amp;v12), (v9 = (<span class="keyword">char</span> *)v8) != <span class="number">0L</span>L)</span><br><span class="line">      &amp;&amp; v12 &gt; <span class="number">0</span></span><br><span class="line">      &amp;&amp; (<span class="keyword">unsigned</span> __int16)crc16((__int64)v8, v12) == <span class="number">0x69E2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0L</span>L; v12 &gt; (<span class="keyword">signed</span> <span class="keyword">int</span>)i; ++i )</span><br><span class="line">        v9[i] ^= <span class="number">0x17</span>u;</span><br><span class="line">      <span class="built_in">puts</span>(v9);</span><br><span class="line">      <span class="keyword">if</span> ( ptr )</span><br><span class="line">        <span class="built_in">free</span>(ptr);</span><br><span class="line">      <span class="built_in">free</span>(v9);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"input flag is wrong!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"input is too short!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到输入后的字符串进行了一大堆看不懂的操作，但是能推测出来输入的长度为16位</p>
<p>用ida调试可知，change_into_number这个函数把输入的字符串进行了转换</p>
<p>完成了16进制字符串 -&gt; 16进制整数的过程</p>
<h3 id="xtea-keychanged中的一个子函数"><a href="#xtea-keychanged中的一个子函数" class="headerlink" title="xtea_keychanged中的一个子函数"></a>xtea_keychanged中的一个子函数</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_55883B5AECE0</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">signed</span> <span class="keyword">int</span> a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// er12</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// r13</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// er14</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v10; <span class="comment">// er15</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v11; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// er8</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v17; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v25; <span class="comment">// er11</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// r13</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// er14</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v28; <span class="comment">// er12</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v29; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v32; <span class="comment">// er9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v33; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v35; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v36; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v38; <span class="comment">// er15</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v40; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">int</span> v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">bool</span> v42; <span class="comment">// zf</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v43; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v45; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line"></span><br><span class="line">  v3 = a3;</span><br><span class="line">  v4 = a2;</span><br><span class="line">  v5 = *a1;</span><br><span class="line">  v43 = a2;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = a2 - <span class="number">1</span>;</span><br><span class="line">    v7 = &amp;a1[a2 - <span class="number">1</span>];</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    v9 = *v7;</span><br><span class="line">    v10 = ((a2 - <span class="number">4</span>) &amp; <span class="number">0xFFFFFFFE</span>) + <span class="number">2</span>;</span><br><span class="line">    v45 = <span class="number">0x9E3779B9</span> * (<span class="number">52</span> / a2) - <span class="number">0x4AB325AA</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 -= <span class="number">0x61C88647</span>;</span><br><span class="line">      v11 = v8 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v43 &lt;= <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v12 = *a1;</span><br><span class="line">        v13 = a1;</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v15 = v13[<span class="number">1</span>];</span><br><span class="line">          v13 += <span class="number">2</span>;</span><br><span class="line">          v16 = (v9 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v14 ^ (<span class="keyword">unsigned</span> __int8)v11) &amp; <span class="number">3</span>))) + (v15 ^ v8);</span><br><span class="line">          v17 = v14 + <span class="number">1</span>;</span><br><span class="line">          v14 += <span class="number">2</span>;</span><br><span class="line">          v18 = v12 + ((((v9 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v15) + ((v15 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v9)) ^ v16);</span><br><span class="line">          v12 = *v13;</span><br><span class="line">          *(v13 - <span class="number">2</span>) = v18;</span><br><span class="line">          v9 = v15</span><br><span class="line">             + (((<span class="number">4</span> * v12 ^ (v18 &gt;&gt; <span class="number">5</span>)) + (<span class="number">16</span> * v18 ^ (v12 &gt;&gt; <span class="number">3</span>))) ^ ((v12 ^ v8)</span><br><span class="line">                                                                    + (v18 ^ *(_DWORD *)(v3</span><br><span class="line">                                                                                       + <span class="number">4L</span>L</span><br><span class="line">                                                                                       * (((<span class="keyword">unsigned</span> __int8)v11 ^ v17) &amp; <span class="number">3</span>)))));</span><br><span class="line">          *(v13 - <span class="number">1</span>) = v9;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v10 != v14 );</span><br><span class="line">      &#125;</span><br><span class="line">      v19 = &amp;a1[v14];</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v20 = v19[<span class="number">1</span>];</span><br><span class="line">        v21 = v11 ^ v14++;</span><br><span class="line">        ++v19;</span><br><span class="line">        v22 = *(v19 - <span class="number">1</span>)</span><br><span class="line">            + (((v9 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (v21 &amp; <span class="number">3</span>))) + (v20 ^ v8)) ^ ((<span class="number">16</span> * v9 ^ (v20 &gt;&gt; <span class="number">3</span>)) + ((v9 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v20)));</span><br><span class="line">        *(v19 - <span class="number">1</span>) = v22;</span><br><span class="line">        v9 = v22;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v6 &gt; v14 );</span><br><span class="line">      v9 = *v7</span><br><span class="line">         + (((v22 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v6 ^ (<span class="keyword">unsigned</span> __int8)v11) &amp; <span class="number">3</span>))) + (*a1 ^ v8)) ^ ((<span class="number">4</span> * *a1 ^ (v22 &gt;&gt; <span class="number">5</span>)) + (<span class="number">16</span> * v22 ^ ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*a1 &gt;&gt; <span class="number">3</span>))));</span><br><span class="line">      *v7 = v9;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v8 != v45 );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">1L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &lt; <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v24 = -a2;</span><br><span class="line">    v25 = <span class="number">-1640531527</span> * (<span class="number">52</span> / v24 + <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v25 )</span><br><span class="line">    &#123;</span><br><span class="line">      v26 = &amp;a1[v24 - <span class="number">1</span>];</span><br><span class="line">      v27 = ~v4;</span><br><span class="line">      v44 = &amp;a1[~v4];</span><br><span class="line">      v28 = ~v4 - <span class="number">2</span> - ((~v4 - <span class="number">3</span>) &amp; <span class="number">0xFFFFFFFE</span>);</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v29 = v25 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v27 &lt;= <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v31 = v27;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v30 = v44;</span><br><span class="line">          v31 = v27;</span><br><span class="line">          v32 = *v44;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            v33 = *(v30 - <span class="number">1</span>);</span><br><span class="line">            v30 -= <span class="number">2</span>;</span><br><span class="line">            v34 = v32;</span><br><span class="line">            v32 = *v30;</span><br><span class="line">            v35 = ((v5 ^ v25) + (v33 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v31 ^ (<span class="keyword">unsigned</span> __int8)v29) &amp; <span class="number">3</span>)))) ^ ((<span class="number">4</span> * v5 ^ (v33 &gt;&gt; <span class="number">5</span>)) + ((v5 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v33));</span><br><span class="line">            v36 = v31 - <span class="number">1</span>;</span><br><span class="line">            v31 -= <span class="number">2</span>;</span><br><span class="line">            v37 = v34 - v35;</span><br><span class="line">            v38 = *v30;</span><br><span class="line">            v30[<span class="number">2</span>] = v37;</span><br><span class="line">            v5 = v33</span><br><span class="line">               - (((<span class="number">16</span> * v38 ^ (v37 &gt;&gt; <span class="number">3</span>)) + ((v32 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v37)) ^ ((v32 ^ *(_DWORD *)(v3</span><br><span class="line">                                                                                         + <span class="number">4L</span>L</span><br><span class="line">                                                                                         * (((<span class="keyword">unsigned</span> __int8)v29 ^ v36) &amp; <span class="number">3</span>)))</span><br><span class="line">                                                                      + (v25 ^ v37)));</span><br><span class="line">            v30[<span class="number">1</span>] = v5;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( v28 != v31 );</span><br><span class="line">        &#125;</span><br><span class="line">        v39 = &amp;a1[v31];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v40 = *(v39 - <span class="number">1</span>);</span><br><span class="line">          --v39;</span><br><span class="line">          v5 = v39[<span class="number">1</span>]</span><br><span class="line">             - (((v5 ^ v25) + (v40 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v29 ^ (<span class="keyword">unsigned</span> __int8)v31) &amp; <span class="number">3</span>)))) ^ (((v5 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v40) + ((v40 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v5)));</span><br><span class="line">          v39[<span class="number">1</span>] = v5;</span><br><span class="line">          --v31;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v31 );</span><br><span class="line">        v41 = *a1</span><br><span class="line">            - (((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*v26 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v5) + (<span class="number">16</span> * *v26 ^ (v5 &gt;&gt; <span class="number">3</span>))) ^ ((*(_DWORD *)(v3 + <span class="number">4L</span>L * (v29 &amp; <span class="number">3</span>)) ^ *v26)</span><br><span class="line">                                                                                 + (v25 ^ v5)));</span><br><span class="line">        v42 = v25 == <span class="number">-1640531527</span>;</span><br><span class="line">        v25 += <span class="number">1640531527</span>;</span><br><span class="line">        v5 = v41;</span><br><span class="line">        *a1 = v41;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( !v42 );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由0x9E3779B9可知，这是一个xtea加密（解密）算法</p>
<p>然后加解密所使用的常数有所改变，是内存中的16字节的数组</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">xtea(v8, -(v10 &gt;&gt; <span class="number">2</span>), constant)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个 -(v10 &gt;&gt; 2)明显是一个负数，而xtea函数为负时，就是解密的过程</p>
</blockquote>
<blockquote>
<p>在调试时xtea_keychanged这个函数执行完后就直接报wrong</p>
</blockquote>
<p>经高人指点，这个是xtea解密失败，程序判断这个密码解不出来，就直接报错了</p>
<h3 id="xtea-keychanged"><a href="#xtea-keychanged" class="headerlink" title="xtea_keychanged"></a>xtea_keychanged</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> *__<span class="function">fastcall <span class="title">xtea_keychanged</span><span class="params">(<span class="keyword">void</span> *src, <span class="keyword">int</span> const_8, __int64 a3, <span class="keyword">int</span> a4, <span class="keyword">int</span> *a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// er12</span></span><br><span class="line">  __int64 constant; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">int</span> *<span class="built_in">string</span>; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// er12</span></span><br><span class="line"></span><br><span class="line">  v5 = a5;</span><br><span class="line">  <span class="keyword">if</span> ( !src || (v6 = const_8, const_8 &lt;= <span class="number">0</span>) || (constant = a3) == <span class="number">0</span> || a4 != <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !a5 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">string</span> = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( a5 )</span><br><span class="line">  &#123;</span><br><span class="line">    *a5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !(const_8 &amp; <span class="number">3</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(const_8 + <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">string</span> = v9;</span><br><span class="line">      <span class="keyword">if</span> ( v9 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(v9, src, const_8);               <span class="comment">// v9 存储了输入的16进制数</span></span><br><span class="line">        v10 = const_8 + <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">          v10 = v6;</span><br><span class="line">        xtea(<span class="built_in">string</span>, -(v10 &gt;&gt; <span class="number">2</span>), constant);    <span class="comment">// xtea对输入的字符串进行解密</span></span><br><span class="line">        v11 = *((<span class="keyword">unsigned</span> __int8 *)<span class="built_in">string</span> + v6 - <span class="number">1</span>);<span class="comment">// 取第八个字符</span></span><br><span class="line">        *((_BYTE *)<span class="built_in">string</span> + v6) = <span class="number">0</span>;</span><br><span class="line">        *v5 = v6;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; v11 &amp;&amp; v11 &lt;= <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v13 = v6 - v11;                       <span class="comment">// 8 - v11</span></span><br><span class="line">          *v5 = v13;</span><br><span class="line">          *((_BYTE *)<span class="built_in">string</span> + v13) = <span class="number">0</span>;         <span class="comment">// 把某一位置零了</span></span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">string</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(<span class="built_in">string</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *v5 = <span class="number">0</span>;</span><br><span class="line">LABEL_14:</span><br><span class="line">    <span class="built_in">string</span> = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">*((_BYTE *)<span class="built_in">string</span> + v13) = <span class="number">0</span>;         <span class="comment">// 把某一位置零了</span></span><br></pre></td></tr></table></figure>

<p>这句话很关键，把某一位截断了，而这一位只能是倒数第二位</p>
<h3 id="crc16"><a href="#crc16" class="headerlink" title="crc16"></a>crc16</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_55883B5AF3D0</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// r12</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  __int16 v4; <span class="comment">// ax</span></span><br><span class="line">  __int16 v5; <span class="comment">// ax</span></span><br><span class="line">  __int16 v6; <span class="comment">// dx</span></span><br><span class="line">  __int16 v7; <span class="comment">// ax</span></span><br><span class="line">  __int16 v8; <span class="comment">// dx</span></span><br><span class="line">  __int16 v9; <span class="comment">// ax</span></span><br><span class="line">  __int16 v10; <span class="comment">// dx</span></span><br><span class="line">  __int16 v11; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v13; <span class="comment">// [rsp+5h] [rbp-23h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v14; <span class="comment">// [rsp+6h] [rbp-22h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+8h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = a1;</span><br><span class="line">    v3 = a1 + (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(a2 - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v13 = *(_BYTE *)(++v2 - <span class="number">1</span>);</span><br><span class="line">        sub_55883B5AF270(&amp;v13, &amp;v13);</span><br><span class="line">        v4 = v14 ^ (v13 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">if</span> ( ((v14 ^ (v13 &lt;&lt; <span class="number">8</span>)) &amp; <span class="number">0x8000</span>u) != <span class="number">0</span> )</span><br><span class="line">          v5 = <span class="number">2</span> * v4 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          v5 = <span class="number">2</span> * v4;</span><br><span class="line">        v6 = <span class="number">2</span> * v5 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v5 &gt;= <span class="number">0</span> )</span><br><span class="line">          v6 = <span class="number">2</span> * v5;</span><br><span class="line">        v7 = <span class="number">2</span> * v6 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">          v7 = <span class="number">2</span> * v6;</span><br><span class="line">        v8 = <span class="number">2</span> * v7 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v7 &gt;= <span class="number">0</span> )</span><br><span class="line">          v8 = <span class="number">2</span> * v7;</span><br><span class="line">        v9 = <span class="number">2</span> * v8 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v8 &gt;= <span class="number">0</span> )</span><br><span class="line">          v9 = <span class="number">2</span> * v8;</span><br><span class="line">        v10 = <span class="number">2</span> * v9 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> )</span><br><span class="line">          v10 = <span class="number">2</span> * v9;</span><br><span class="line">        v11 = <span class="number">2</span> * v10 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= <span class="number">0</span> )</span><br><span class="line">          v11 = <span class="number">2</span> * v10;</span><br><span class="line">        <span class="keyword">if</span> ( v11 &lt; <span class="number">0</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v14 = <span class="number">2</span> * v11;</span><br><span class="line">        <span class="keyword">if</span> ( v2 == v3 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">      &#125;</span><br><span class="line">      v14 = <span class="number">2</span> * v11 ^ <span class="number">0x1021</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v2 != v3 );</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_19:</span><br><span class="line">  sub_55883B5AF2D0(&amp;v14, &amp;v14);</span><br><span class="line">  <span class="keyword">return</span> v14;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也是通过0x1021可知，这是一个crc16校验，校验码为0x1021</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 == v3 )</span><br><span class="line">     <span class="keyword">goto</span> LABEL_19;</span><br></pre></td></tr></table></figure>

<p>由这句话可知，v2会从起始字节一直遍历到v3处，那么a2就要构造得刚好把这些值覆盖，可知a2=6，所以解密后的那个数组的最后一个字节就是2</p>
<p>调试tips:</p>
<blockquote>
<p> 有效的加密字符串 4290cd6dc6ae54cc</p>
<p>解密后得0123456789abcd02</p>
</blockquote>
<h3 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h3><ol>
<li>程序读入16位的十六进制数，并转化为8字节</li>
<li>将数据进行xtea解密</li>
</ol>
<blockquote>
<p>同时这个自带加密函数，只需要把输入的参数取反，就是逆过程了</p>
</blockquote>
<ol>
<li>将解密后的数据进行crc16校验（校验码为0x1021），得到结果<strong>0x69E2</strong></li>
<li>这个解密后的数组去异或0x17能得到”Bingo!” 字符串</li>
</ol>
<h2 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc16</span><span class="params">(data: bytes, poly=<span class="number">0x1021</span>)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    CRC-16-CCITT Algorithm</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    data = bytearray(data)</span><br><span class="line">    crc = <span class="number">0xFFFF</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        cur_byte = <span class="number">0xFF</span> &amp; b</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> (crc &amp; <span class="number">0x0001</span>) ^ (cur_byte &amp; <span class="number">0x0001</span>):</span><br><span class="line">                crc = (crc &gt;&gt; <span class="number">1</span>) ^ poly</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                crc &gt;&gt;= <span class="number">1</span></span><br><span class="line">            cur_byte &gt;&gt;= <span class="number">1</span></span><br><span class="line">    crc = (~crc &amp; <span class="number">0xFFFF</span>)</span><br><span class="line">    crc = (crc &lt;&lt; <span class="number">8</span>) | ((crc &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> crc &amp; <span class="number">0xFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc = <span class="string">"Bingo!"</span></span><br><span class="line">dec = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    dec.append(hex(ord(i) ^ <span class="number">0x17</span>))</span><br><span class="line">dec.append(hex(<span class="number">6</span>))</span><br><span class="line">dec.append(hex(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">print(dec)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>557e797078360602</p>
</blockquote>
<p>然后再拿这个字符串去加密一遍，就得到flag了</p>
<blockquote>
<p>rctf{2a2e71aab6168fb6}</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>] Accepting connection <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.133</span><span class="number">.1</span>...</span><br><span class="line">Input right flag you can got <span class="string">'Bingo!'</span> :<span class="number">2</span>a2e71aab6168fb6</span><br><span class="line"></span><br><span class="line">    Bingo!</span><br></pre></td></tr></table></figure>

<blockquote>
<p>后续：据说倒数第二字节是个padding</p>
<p>有空再填坑  <a href="https://blog.csdn.net/shift_wwx/article/details/84256774" target="_blank" rel="noopener">https://blog.csdn.net/shift_wwx/article/details/84256774</a></p>
</blockquote>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>mrh929
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://mrh1s.top/posts/122a7c75/" title="rctf_babyre1">https://mrh1s.top/posts/122a7c75/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/RE-Static/" rel="tag"># RE_Static</a>
              <a href="/tags/xtea/" rel="tag"># xtea</a>
              <a href="/tags/crc16/" rel="tag"># crc16</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/74b676c7/" rel="prev" title="ccsp2019西南赛区">
      <i class="fa fa-chevron-left"></i> ccsp2019西南赛区
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/8b232dcf/" rel="next" title="rctf_babyre2">
      rctf_babyre2 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RCTF-babyre1"><span class="nav-number">1.</span> <span class="nav-text">RCTF_babyre1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#思路"><span class="nav-number">1.1.</span> <span class="nav-text">思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#main"><span class="nav-number">1.1.1.</span> <span class="nav-text">main</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xtea-keychanged中的一个子函数"><span class="nav-number">1.1.2.</span> <span class="nav-text">xtea_keychanged中的一个子函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xtea-keychanged"><span class="nav-number">1.1.3.</span> <span class="nav-text">xtea_keychanged</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crc16"><span class="nav-number">1.1.4.</span> <span class="nav-text">crc16</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#大致思路"><span class="nav-number">1.1.5.</span> <span class="nav-text">大致思路</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#solve"><span class="nav-number">1.2.</span> <span class="nav-text">solve</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">mrh929</p>
  <div class="site-description" itemprop="description">Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/_posts/">
        
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mrh929</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
