<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://mrh1s.top').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="mrh929&#39;s home">
<meta property="og:url" content="https://mrh1s.top/page/3/index.html">
<meta property="og:site_name" content="mrh929&#39;s home">
<meta property="og:description" content="Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mrh929&#39;s home">
<meta name="twitter:description" content="Blog">

<link rel="canonical" href="https://mrh1s.top/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>mrh929's home</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mrh929's home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/6f2d090a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/6f2d090a/" class="post-title-link" itemprop="url">在linux上搭建minecraft java版服务器</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-06-09 11:36:09 / Modified: 13:17:14" itemprop="dateCreated datePublished" datetime="2019-06-09T11:36:09+08:00">2019-06-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tips/" itemprop="url" rel="index">
                    <span itemprop="name">Tips</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="如何在Linux上搭建Minecraft服务器"><a href="#如何在Linux上搭建Minecraft服务器" class="headerlink" title="如何在Linux上搭建Minecraft服务器"></a>如何在Linux上搭建Minecraft服务器</h1><blockquote>
<p>搭建minecraft服务器并不复杂，只需要一些linux的基础操作知识就行了</p>
</blockquote>
<p>灵感来自<a href="https://blog.csdn.net/iwts_24/article/details/79181972" target="_blank" rel="noopener">csdn</a>，教程为自己编写.</p>
<h2 id="购买服务器"><a href="#购买服务器" class="headerlink" title="购买服务器"></a>购买服务器</h2><p>我选择的是<a href="https://promotion.aliyun.com/ntms/act/campus2018.html?spm=5176.10695662.1244717.1.17df4336v6PBv6" target="_blank" rel="noopener">阿里云学生机</a>，这样的配置能带好几个人加上几个大mod，几个小伙伴一起玩已经足够了</p>
<p>理论上Ubuntu也可以使用，不过这个教程里面的指令都是基于centOS的</p>
<p><img src="https://i.loli.net/2019/06/09/5cfc7f897c0d832894.png" alt="Snipaste_2019-06-09_11-39-45.png"></p>
<h2 id="配置服务器"><a href="#配置服务器" class="headerlink" title="配置服务器"></a>配置服务器</h2><h3 id="查看java版本"><a href="#查看java版本" class="headerlink" title="查看java版本"></a>查看java版本</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java --version</span><br></pre></td></tr></table></figure>

<p>如果提示</p>
<blockquote>
<p>[root@vultr /]# java –version<br>-bash: java: command not found</p>
</blockquote>
<p>则说明没有安装java</p>
<p>安装java</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install java-1.8.0-openjdk</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="选择目录"><a href="#选择目录" class="headerlink" title="选择目录"></a>选择目录</h3><p>然后自己找一个想装mc的目录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd usr</span><br><span class="line">mkdir minecraft</span><br><span class="line">cd minecraft</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="获取mc服务器端"><a href="#获取mc服务器端" class="headerlink" title="获取mc服务器端"></a>获取mc服务器端</h3><p>根据你玩的mc的版本，可以下载相应的jar包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wget https://s3.amazonaws.com/Minecraft.Download/versions/版本号/minecraft_server.版本号.jar</span><br></pre></td></tr></table></figure>

<p>以我的为例，目前支持mod的最新版本是1.12.2</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wget https://s3.amazonaws.com/Minecraft.Download/versions/1.12.2/minecraft_server.1.12.2.jar</span><br></pre></td></tr></table></figure>

<h2 id="开启游戏！"><a href="#开启游戏！" class="headerlink" title="开启游戏！"></a>开启游戏！</h2><h3 id="创建启动脚本"><a href="#创建启动脚本" class="headerlink" title="创建启动脚本"></a>创建启动脚本</h3><p>在这之前，先创建一个启动脚本，方便后续一键启动</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo vi start.sh</span><br></pre></td></tr></table></figure>

<p>在start.sh填入如下的内容</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo java -Xms120m -Xmx160m -jar /usr/minecraft/minecraft_server.1.12.2.jar nogui</span><br></pre></td></tr></table></figure>

<p>其中120m,160m分别是给服务器分配的内存,建议如果是开forege服的话把最大内存调高一点,不然mod带不动</p>
<hr>
<h3 id="开启"><a href="#开启" class="headerlink" title="开启"></a>开启</h3><p>开启服务器</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bash start.sh</span><br></pre></td></tr></table></figure>

<p>不要着急，这里一定启动不了的，因为你没有同意用户协议</p>
<blockquote>
<p>[04:00:32] [Server thread/INFO]: You need to agree to the EULA in order to run the server. Go to eula.txt for more info.</p>
</blockquote>
<p>打开eula.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vi eula.txt</span><br></pre></td></tr></table></figure>

<p>把false改为true</p>
<blockquote>
<p>eula=true</p>
</blockquote>
<h3 id="安装forge"><a href="#安装forge" class="headerlink" title="安装forge"></a>安装forge</h3><p>现在已经可以启动服务器了，<strong>无mod需求的可以直接开服,无需进行下面的步骤</strong></p>
<p>但是我们还是无法运行mod，需要安装forge</p>
<p>可以去<a href="https://files.minecraftforge.net/maven/net/minecraftforge/forge/index_1.12.2.html" target="_blank" rel="noopener">官网</a>自行下载，也可以用我的指令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo wget https://files.minecraftforge.net/maven/net/minecraftforge/forge/1.12.2-14.23.5.2768/forge-1.12.2-14.23.5.2768-installer.jar</span><br></pre></td></tr></table></figure>

<p>接下来是安装forge</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -jar forge-1.12.2-14.23.5.2768-installer.jar nogui --installServer</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Extracting: /forge-1.12.2-14.23.5.2768-universal.jar<br>To:          /usr/minecraft/./forge-1.12.2-14.23.5.2768-universal.jar<br>The server installed successfully, you should now be able to run the file forge-1.12.2-14.23.5.2768-universal.jar<br>You can delete this installer file now if you wish</p>
</blockquote>
<p>这个 <strong>forge-1.12.2-14.23.5.2768-universal.jar</strong> 就是启动forge服务器的启动端</p>
<p>打开start.sh把原版启动程序换为forge的启动程序</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo vi start.sh</span><br></pre></td></tr></table></figure>

<blockquote>
<p>填入</p>
<p>sudo java -Xms120m -Xmx160m -jar /usr/minecraft/forge-1.12.2-14.23.5.2768-universal.jar nogui</p>
</blockquote>
<h3 id="开服"><a href="#开服" class="headerlink" title="开服"></a>开服</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bash start.sh</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[04:22:29] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing start region for level 0<br>[04:22:30] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 2%<br>[04:22:32] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 4%<br>[04:22:33] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 7%<br>[04:22:49] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 50%<br>[04:22:50] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 52%<br>[04:22:55] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 64%<br>[04:23:05] [Server thread/INFO] [minecraft/MinecraftServer]: Preparing spawn area: 97%<br>[04:23:06] [Server thread/INFO] [minecraft/DedicatedServer]: Done (39.625s)! For help, type “help” or “?”</p>
</blockquote>
<h2 id="其他补充"><a href="#其他补充" class="headerlink" title="其他补充"></a>其他补充</h2><h3 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h3><p>开服之后的服务器其实并不稳定,只要你关闭远程连接,mc便会自动结束</p>
<p>为了解决这个问题 就要用到screen工具</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install screen</span><br></pre></td></tr></table></figure>

<p>在开服之前,先创建一个screen</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">screen -S mc</span><br></pre></td></tr></table></figure>

<p>创建好screen之后再开启mc服务器</p>
<p>当然,如果需要切换出来 , 按一下Ctrl+a  再按一下d即可</p>
<blockquote>
<p>[root@vultr ~]# screen -S mc<br>[detached from 7293.mc]<br>[root@vultr ~]# </p>
</blockquote>
<p>下次还需进入该screen,就不需要创建了,直接</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">screen -r mc</span><br></pre></td></tr></table></figure>

<h3 id="mod"><a href="#mod" class="headerlink" title="mod"></a>mod</h3><p>要加载mod,将服务器端使用的mod放入<strong>/usr/minecraft/mods</strong>文件夹,重启mc服务器即可</p>
<h3 id="server-properties"><a href="#server-properties" class="headerlink" title="server.properties"></a>server.properties</h3><p>配置文件修改,具体请参照<a href="https://minecraft.gamepedia.com/Server.properties" target="_blank" rel="noopener">官方文档</a></p>
<p>通常是把pvp,正版检测关闭</p>
<p>还可以限制总加入人数,服务器难度,以及最大高度等等</p>
<h6 id="Java-Edition"><a href="#Java-Edition" class="headerlink" title="Java Edition"></a>Java Edition</h6><table>
<thead>
<tr>
<th align="center">Key</th>
<th align="center">Type</th>
<th align="center">Default Value</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>allow-flight</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Allows users to use flight on your server while in Survival mode, if they have a <a href="https://minecraft.gamepedia.com/Mod" target="_blank" rel="noopener">mod</a>that provides flight installed.With allow-flight enabled, <a href="https://minecraft.gamepedia.com/Griefers" target="_blank" rel="noopener">griefers</a> will possibly be more common, because it will make their work easier. In Creative mode this has no effect.<strong>false</strong> - Flight is not allowed (players in air for at least 5 seconds will be kicked).<strong>true</strong> - Flight is allowed, and used if the player has a fly mod installed.</td>
</tr>
<tr>
<td align="center"><strong>allow-nether</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Allows players to travel to the <a href="https://minecraft.gamepedia.com/Nether" target="_blank" rel="noopener">Nether</a>.<strong>false</strong> - <a href="https://minecraft.gamepedia.com/Nether" target="_blank" rel="noopener">Nether</a> portals will not work.<strong>true</strong> - The server will allow <a href="https://minecraft.gamepedia.com/Portal" target="_blank" rel="noopener">portals</a> to send players to the Nether.</td>
</tr>
<tr>
<td align="center"><strong>difficulty</strong></td>
<td align="center">string</td>
<td align="center">easy</td>
<td align="center">Defines the <a href="https://minecraft.gamepedia.com/Difficulty" target="_blank" rel="noopener">difficulty</a> (such as damage dealt by mobs and the way hunger and poison affects players) of the server.If a legacy difficulty number is specified it will be silently converted to a difficulty name.<strong>peaceful</strong> (0)<strong>easy</strong> (1)<strong>normal</strong> (2)<strong>hard</strong> (3)</td>
</tr>
<tr>
<td align="center"><strong>enable-command-block</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Enables command blocks</td>
</tr>
<tr>
<td align="center"><strong>enable-query</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Enables GameSpy4 protocol server listener. Used to get information about server.</td>
</tr>
<tr>
<td align="center"><strong>enable-rcon</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Enables remote access to the server console.</td>
</tr>
<tr>
<td align="center"><strong>force-gamemode</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Force players to join in the default <a href="https://minecraft.gamepedia.com/Game_mode" target="_blank" rel="noopener">game mode</a>.<strong>false</strong> - Players will join in the gamemode they left in.<strong>true</strong> - Players will always join in the default gamemode.</td>
</tr>
<tr>
<td align="center"><strong>gamemode</strong></td>
<td align="center">string</td>
<td align="center">survival</td>
<td align="center">Defines the <a href="https://minecraft.gamepedia.com/Game_mode" target="_blank" rel="noopener">mode of gameplay</a>.If a legacy gamemode number is specified it will be silently converted to a gamemode name.<strong>survival</strong> (0)<strong>creative</strong> (1)<strong>adventure</strong> (2)<strong>spectator</strong> (3)</td>
</tr>
<tr>
<td align="center"><strong>generate-structures</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Defines whether <a href="https://minecraft.gamepedia.com/Structures" target="_blank" rel="noopener">structures</a> (such as villages) will be generated.<strong>false</strong> - Structures will not be generated in new chunks.<strong>true</strong> - Structures will be generated in new chunks.<strong>Note:</strong> <em>Dungeons will still generate if this is set to false.</em></td>
</tr>
<tr>
<td align="center"><strong>generator-settings</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">The settings used to customize world generation. See <a href="https://minecraft.gamepedia.com/Superflat" target="_blank" rel="noopener">Superflat</a> and <a href="https://minecraft.gamepedia.com/Customized" target="_blank" rel="noopener">Customized</a> for possible settings and examples.</td>
</tr>
<tr>
<td align="center"><strong>hardcore</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">If set to <strong>true</strong>, server difficulty is ignored and set to hard and players will be set to spectator mode if they die.</td>
</tr>
<tr>
<td align="center"><strong>level-name</strong></td>
<td align="center">string</td>
<td align="center">world</td>
<td align="center">The “level-name” value will be used as the world name and its folder name. You may also copy your saved game folder here, and change the name to the same as that folder’s to load it instead.Characters such as ‘ (apostrophe) may need to be escaped by adding a backslash before them.</td>
</tr>
<tr>
<td align="center"><strong>level-seed</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">Add a <a href="https://minecraft.gamepedia.com/Seed_(level_generation)" target="_blank" rel="noopener">seed</a> for your world, as in Singleplayer.Some examples are: minecraft, 404, 1a2b3c.</td>
</tr>
<tr>
<td align="center"><strong>level-type</strong></td>
<td align="center">string</td>
<td align="center">default</td>
<td align="center">Determines the type of map that is generated.<strong>default</strong> - Standard world with hills, valleys, water, etc.<strong>flat</strong> - A flat world with no features, can be modified with <strong>generator-settings</strong>.<strong>largebiomes</strong> - Same as default but all biomes are larger.<strong>amplified</strong> - Same as default but world-generation height limit is increased.<strong>buffet</strong> - Same as default unless <strong>generator-settings</strong> is set to a preset.</td>
</tr>
<tr>
<td align="center"><strong>max-build-height</strong></td>
<td align="center">integer</td>
<td align="center">256</td>
<td align="center">The maximum height in which building is allowed. Terrain may still naturally generate above a low height limit.</td>
</tr>
<tr>
<td align="center"><strong>max-players</strong></td>
<td align="center">integer (0-2147483647)</td>
<td align="center">20</td>
<td align="center">The maximum number of players that can play on the server at the same time. Note that if more players are on the server it will use more resources. Note also, op player connections are not supposed to count against the max players, but ops currently cannot join a full server. However, this can be changed by going to the file called ops.json in your server directory, opening it, finding the op you want the change, and changing the setting called bypassesPlayerLimit to true (the default is false). This means that that op will not have to wait for a player to leave in order to join. Extremely large values for this field result in the client-side user list being broken.</td>
</tr>
<tr>
<td align="center"><strong>max-tick-time</strong></td>
<td align="center">integer (0–(2^63 - 1))</td>
<td align="center">60000</td>
<td align="center">The maximum number of milliseconds a single tick may take before the server watchdog stops the server with the message, <em>A single server tick took 60.00 seconds (should be max 0.05); Considering it to be crashed, server will forcibly shutdown.</em> Once this criterion is met, it calls System.exit(1).<strong>-1</strong> - disable watchdog entirely (this disable option was added in 14w32a)</td>
</tr>
<tr>
<td align="center"><strong>max-world-size</strong></td>
<td align="center">integer (1-29999984)</td>
<td align="center">29999984</td>
<td align="center">This sets the maximum possible size in blocks, expressed as a radius, that the <a href="https://minecraft.gamepedia.com/World_border" target="_blank" rel="noopener">world border</a> can obtain. Setting the world border bigger causes the commands to complete successfully but the actual border will not move past this block limit. Setting the max-world-size higher than the default doesn’t appear to do anything.Examples:Setting max-world-size to 1000 will allow you to have a 2000x2000 world border.Setting max-world-size to 4000 will give you an 8000 x 8000 world border.</td>
</tr>
<tr>
<td align="center"><strong>motd</strong></td>
<td align="center">string</td>
<td align="center"><em>A Minecraft Server</em></td>
<td align="center">This is the message that is displayed in the server list of the client, below the name.The MOTD supports <a href="https://minecraft.gamepedia.com/Formatting_codes" target="_blank" rel="noopener">color and formatting codes</a>.The MOTD supports special characters, such as “♥”. However, such characters must be converted to escaped Unicode form. An online converter can be found <a href="http://www.freeformatter.com/string-utilities.html#charinfo" target="_blank" rel="noopener">here</a>.If the MOTD is over 59 characters, the server list will likely report a communication error.</td>
</tr>
<tr>
<td align="center"><strong>network-compression-threshold</strong></td>
<td align="center">integer</td>
<td align="center">256</td>
<td align="center">By default it allows packets that are <em>n-1</em> bytes big to go normally, but a packet that <em>n</em>bytes or more will be compressed down. So, lower number means more compression but compressing small amounts of bytes might actually end up with a larger result than what went in.<strong>-1</strong> - disable compression entirely<strong>0</strong> - compress everything<strong>Note:</strong> <em>The Ethernet spec requires that packets less than 64 bytes become padded to 64 bytes. Thus, setting a value lower than 64 may not be beneficial. It is also not recommended to exceed the MTU, typically 1500 bytes.</em></td>
</tr>
<tr>
<td align="center"><strong>online-mode</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Server checks connecting players against <em>Minecraft</em> account database. Only set this to false if your server is <strong>not</strong> connected to the Internet. Hackers with fake accounts can connect if this is set to false! If minecraft.net is down or inaccessible, no players will be able to connect if this is set to true. Setting this variable to off purposely is called “cracking” a server, and servers that are presently with online mode off are called “cracked” servers, allowing players with unlicensed copies of <em>Minecraft</em> to join.<strong>true</strong> - Enabled. The server will assume it has an Internet connection and check every connecting player.<strong>false</strong> - Disabled. The server will not attempt to check connecting players.</td>
</tr>
<tr>
<td align="center"><strong>op-permission-level</strong></td>
<td align="center">integer (1-4)</td>
<td align="center">4</td>
<td align="center">Sets the default permission level for ops when using <code>/op</code>. All levels inherit abilities and commands from levels before them.<strong>1</strong> - Ops can bypass spawn protection.<strong>2</strong> - Ops can use all singleplayer cheats commands (except <code>/publish</code>, as it is not on servers; along with <code>/debug</code> and <code>/reload</code>) and use command blocks. Command blocks, along with Realms owners/operators, have the same permissions as this level.<strong>3</strong> - Ops can use most multiplayer-exclusive commands, including <code>/debug</code>, <code>/reload</code>, and commands that manage players (<code>/ban</code>, <code>/op</code>, etc).<strong>4</strong> - Ops can use all commands including <code>/stop</code>, <code>/save-all</code>, <code>/save-on</code>, <code>/save-off</code>, <code>/forceload add</code>, and <code>/forceload remove</code>.</td>
</tr>
<tr>
<td align="center"><strong>player-idle-timeout</strong></td>
<td align="center">integer</td>
<td align="center">0</td>
<td align="center">If non-zero, players are kicked from the server if they are idle for more than that many minutes.<strong>Note:</strong> <em>Idle time is reset when the server receives one of the following packets:</em><a href="http://wiki.vg/Protocol#Click_Window" target="_blank" rel="noopener">Click Window</a><a href="http://wiki.vg/Protocol#Enchant_Item" target="_blank" rel="noopener">Enchant Item</a><a href="http://wiki.vg/Protocol#Update_Sign" target="_blank" rel="noopener">Update Sign</a><a href="http://wiki.vg/Protocol#Player_Digging" target="_blank" rel="noopener">Player Digging</a><a href="http://wiki.vg/Protocol#Player_Block_Placement" target="_blank" rel="noopener">Player Block Placement</a><a href="http://wiki.vg/Protocol#Held_Item_Change_.28serverbound.29" target="_blank" rel="noopener">Held Item Change</a><a href="http://wiki.vg/Protocol#Animation_.28serverbound.29" target="_blank" rel="noopener">Animation</a> (swing arm)<a href="http://wiki.vg/Protocol#Entity_Action" target="_blank" rel="noopener">Entity Action</a><a href="http://wiki.vg/Protocol#Client_Status" target="_blank" rel="noopener">Client Status</a><a href="http://wiki.vg/Protocol#Chat_Message_.28serverbound.29" target="_blank" rel="noopener">Chat Message</a><a href="http://wiki.vg/Protocol#Use_Entity" target="_blank" rel="noopener">Use Entity</a></td>
</tr>
<tr>
<td align="center">prevent-proxy-connections</td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">If the ISP/AS sent from the server is different from the one from Mojang’s authentication server, the player is kicked<strong>true</strong> - Enabled. Server prevents users from using vpns or proxies.<strong>false</strong> - Disabled. The server doesn’t prevent users from using vpns or proxies.</td>
</tr>
<tr>
<td align="center"><strong>pvp</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Enable PvP on the server. Players shooting themselves with arrows will only receive damage if PvP is enabled.<strong>true</strong> - Players will be able to kill each other.<strong>false</strong> - Players cannot kill other players (also known as <strong>Player versus Environment</strong> (<strong>PvE</strong>)).<strong>Note:</strong> <em>Indirect damage sources spawned by players (such as lava, fire, TNT and to some extent water, sand and gravel) will still deal damage to other players.</em></td>
</tr>
<tr>
<td align="center"><strong>query.port</strong></td>
<td align="center">integer (1-65534)</td>
<td align="center">25565</td>
<td align="center">Sets the port for the query server (see <strong>enable-query</strong>).</td>
</tr>
<tr>
<td align="center"><strong>rcon.password</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">Sets the password to rcon.</td>
</tr>
<tr>
<td align="center"><strong>rcon.port</strong></td>
<td align="center">integer (1-65534)</td>
<td align="center">25575</td>
<td align="center">Sets the port to rcon.</td>
</tr>
<tr>
<td align="center"><strong>resource-pack</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">Optional URI to a <a href="https://minecraft.gamepedia.com/Resource_pack" target="_blank" rel="noopener">resource pack</a>. The player may choose to use it.Note that the “:” and “=” characters need to be escaped with backslash (), e.g. http://somedomain.com/somepack.zip?someparam=somevalueNote download success/failure is logged by the client, not by the server.</td>
</tr>
<tr>
<td align="center"><strong>resource-pack-sha1</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">Optional SHA-1 digest of the resource pack, in lowercase hexadecimal. It’s recommended to specify this. This is not yet used to verify the integrity of the resource pack, but improves the effectiveness and reliability of caching.</td>
</tr>
<tr>
<td align="center"><strong>server-ip</strong></td>
<td align="center">string</td>
<td align="center"><em>blank</em></td>
<td align="center">Set this if you want the server to bind to a particular IP. It is strongly recommended that you leave server-ip blank!Set to blank, or the IP you want your server to run (listen) on.</td>
</tr>
<tr>
<td align="center"><strong>server-port</strong></td>
<td align="center">integer (1-65534)</td>
<td align="center">25565</td>
<td align="center">Changes the port the server is hosting (listening) on. This port must be <a href="https://en.wikipedia.org/wiki/Port_forwarding" target="_blank" rel="noopener">forwarded</a> if the server is hosted in a network using <a href="https://en.wikipedia.org/wiki/Network_address_translation" target="_blank" rel="noopener">NAT</a> (If you have a home router/firewall).</td>
</tr>
<tr>
<td align="center"><strong>snooper-enabled</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Sets whether the server sends snoop data regularly to <a href="http://snoop.minecraft.net/" target="_blank" rel="noopener">http://snoop.minecraft.net</a>.<strong>false</strong> - disable snooping.<strong>true</strong> - enable snooping.</td>
</tr>
<tr>
<td align="center"><strong>spawn-animals</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Determines if <a href="https://minecraft.gamepedia.com/Animal" target="_blank" rel="noopener">animals</a> will be able to spawn.<strong>true</strong> - Animals spawn as normal.<strong>false</strong> - Animals will immediately vanish.<em>Tip: if you have major lag, turn this off/set to false.</em></td>
</tr>
<tr>
<td align="center"><strong>spawn-monsters</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Determines if monsters will be spawned.<strong>true</strong> - Enabled. Monsters will appear at night and in the dark.<strong>false</strong> - Disabled. No monsters.This setting has no effect if difficulty = 0 (peaceful). If difficulty is not = 0, a monster can still spawn from a <a href="https://minecraft.gamepedia.com/Monster_Spawner" target="_blank" rel="noopener">Monster Spawner</a>.<em>Tip: if you have major lag, turn this off/set to false.</em></td>
</tr>
<tr>
<td align="center"><strong>spawn-npcs</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Determines whether villagers will be spawned.<strong>true</strong> - Enabled. Villagers will spawn.<strong>false</strong> - Disabled. No villagers.</td>
</tr>
<tr>
<td align="center"><strong>spawn-protection</strong></td>
<td align="center">integer</td>
<td align="center">16</td>
<td align="center">Determines the radius of the <a href="https://minecraft.gamepedia.com/index.php?title=Spawn_protection&action=edit&redlink=1" target="_blank" rel="noopener">spawn protection</a> as 2<em>x</em>+1. Setting this to 0 will not disable spawn protection. 0 will protect the single block at the spawn point. 1 will protect a 3x3 area centered on the spawn point. 2 will protect 5x5, 3 will protect 7x7, etc. This option is not generated on the first server start and appears when the first player joins. If there are no <a href="https://minecraft.gamepedia.com/Operator" target="_blank" rel="noopener">ops</a> set on the server, the spawn protection will be disabled automatically.</td>
</tr>
<tr>
<td align="center"><strong>use-native-transport</strong></td>
<td align="center">boolean</td>
<td align="center">true</td>
<td align="center">Linux server performance improvements: optimized packet sending/receiving on Linux<strong>true</strong> - Enabled. Enable Linux packet sending/receiving optimization<strong>false</strong> - Disabled. Disable Linux packet sending/receiving optimization</td>
</tr>
<tr>
<td align="center"><strong>view-distance</strong></td>
<td align="center">integer (2-32)</td>
<td align="center">10</td>
<td align="center">Sets the amount of world data the server sends the client, measured in chunks in each direction of the player (radius, not diameter). It determines the server-side viewing distance. (see <a href="https://minecraft.gamepedia.com/Frame_rate#Render_distance" target="_blank" rel="noopener">Render distance</a>)<em>10 is the default/recommended. If you have major lag, reduce this value.<strong><em>*Note:</em></strong> *A value less than 9 will have big impacts on the mobs’ spawn of your server as it mentionned by the bug MC-2536.</em></td>
</tr>
<tr>
<td align="center"><strong>white-list</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Enables a whitelist on the server.With a whitelist enabled, users not on the whitelist will be unable to connect. Intended for private servers, such as those for real-life friends or strangers carefully selected via an application process, for example.<strong>false</strong> - No white list is used.<strong>true</strong> - The file whitelist.json is used to generate the white list.<strong>Note:</strong> <em>Ops are automatically white listed, and there is no need to add them to the whitelist.</em></td>
</tr>
<tr>
<td align="center"><strong>enforce-whitelist</strong></td>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">Enforces the whitelist on the server.When this option is enabled, users who are not present on the whitelist (if it’s enabled) will be kicked from the server after the server reloads the whitelist file.<strong>false</strong> - No user will be kicked if not on the whitelist.<strong>true</strong> - Online users not on the whitelist will be kicked.</td>
</tr>
</tbody></table>
<p>In versions prior to <a href="https://minecraft.gamepedia.com/Java_Edition_1.12" target="_blank" rel="noopener">Java Edition 1.12</a>, the <strong>announce-player-achievements</strong> boolean property (default true) was used to toggle whether <a href="https://minecraft.gamepedia.com/Achievements" target="_blank" rel="noopener">achievements</a>were broadcasted to all players. This property no longer exists, but if it is set, the <code>announceAdvancements</code> <a href="https://minecraft.gamepedia.com/Gamerule" target="_blank" rel="noopener">gamerule</a> will automatically be updated to match and the property will be removed.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/36dd5647/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/36dd5647/" class="post-title-link" itemprop="url">让win10系统任务栏变为透明</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-06-08 00:19:11 / Modified: 11:57:07" itemprop="dateCreated datePublished" datetime="2019-06-08T00:19:11+08:00">2019-06-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tips/" itemprop="url" rel="index">
                    <span itemprop="name">Tips</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="TranslucentTB"><a href="#TranslucentTB" class="headerlink" title="TranslucentTB"></a>TranslucentTB</h2><blockquote>
<p>win10的界面可谓比win7、xp高到不知道哪里去了，然而事物总是有两面性，win10任务栏一直是我们所诟病的一个东西</p>
</blockquote>
<blockquote>
<p>A lightweight utility that makes the Windows taskbar translucent/transparent.</p>
</blockquote>
<p><a href="https://github.com/TranslucentTB/TranslucentTB" target="_blank" rel="noopener">TranslucentTB</a></p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><strong>半透明</strong></p>
<p><img src="https://i.loli.net/2019/06/08/5cfa920826a9d62322.png" alt="Snipaste_2019-06-08_00-32-03.png"></p>
<p><strong>全透明</strong></p>
<p><img src="https://i.loli.net/2019/06/08/5cfa92082ed1c37164.png" alt="Snipaste_2019-06-08_00-31-36.png"></p>
<h3 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h3><blockquote>
<p>看起来现在加了不少功能</p>
<p>主要的还是改变任务栏透明度</p>
</blockquote>
<ul>
<li><p>Advanced <strong>color picker</strong> supporting alpha and live preview to change the taskbar’s color.</p>
</li>
<li><p>Taskbar states</p>
<p>(choose one - color can be customized on every state except Normal):</p>
<ul>
<li><strong>Blur</strong>: Will make the taskbar slightly blurred. <strong>半透明</strong></li>
<li><strong>Clear</strong>: Transparent taskbar. <strong>全透明</strong></li>
<li><strong>Normal</strong>: Regular Windows style. (as if TranslucentTB was not running)  </li>
<li><strong>Opaque</strong>: No transparency.</li>
<li><strong>Fluent</strong>: Windows 10 April 2018 update and up only. Will give the taskbar an appearance similar to Microsoft’s Fluent Design guidelines.</li>
</ul>
</li>
<li><p>Dynamic</p>
<p>modes (these can be used together and each of them provides a taskbar state and color you can customize):</p>
<ul>
<li><strong>Dynamic Windows</strong>: Will change the taskbar to a different appearance if a window is currently maximised.</li>
<li><strong>Dynamic Start Menu</strong>: Will change the taskbar appearance when the start menu is opened.</li>
<li><strong>Dynamic Cortana</strong>: Will change the taskbar appearance when Cortana (or the search menu if Cortana is disabled) is open.</li>
<li><strong>Dynamic Timeline/Task View</strong>: Will change the taskbar apperance when the Timeline (or Task View on older builds) is open.</li>
</ul>
</li>
<li><p>Ability to <strong>show or hide the Aero Peek</strong> button. Can be customized <strong>at will</strong> or <strong>dynamic</strong>.</p>
</li>
</ul>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ol>
<li><a href="https://www.microsoft.com/store/apps/9PF4KZ2VN4W9" target="_blank" rel="noopener">Microsoft Store</a> （最近添加的）</li>
<li><a href="https://github.com/TranslucentTB/TranslucentTB/releases" target="_blank" rel="noopener">the releases tab</a>（zip压缩包）</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/472395fb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/472395fb/" class="post-title-link" itemprop="url">在word中贴出漂亮的代码</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-06-08 00:12:28 / Modified: 00:18:16" itemprop="dateCreated datePublished" datetime="2019-06-08T00:12:28+08:00">2019-06-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tips/" itemprop="url" rel="index">
                    <span itemprop="name">Tips</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><blockquote>
<p>如果你正在写word的实验报告，而苦于word的代码显示错位，那你就来对地方了！</p>
</blockquote>
<h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><ol>
<li>打开这个网页<a href="http://www.planetb.ca/syntax-highlight-word" target="_blank" rel="noopener">PlanetB</a>;</li>
<li>谷歌搜索<strong>syntax highlight code in word documents</strong>，检索结果的第一个</li>
</ol>
<h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><p>​    打开网页，把需要的代码粘贴进去，然后show highlighted即可</p>
<p>​    </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/2946351e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/2946351e/" class="post-title-link" itemprop="url">qwb_JustRe</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-26 10:43:14" itemprop="dateCreated datePublished" datetime="2019-05-26T10:43:14+08:00">2019-05-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-06-14 00:12:46" itemprop="dateModified" datetime="2019-06-14T00:12:46+08:00">2019-06-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/" itemprop="url" rel="index">
                    <span itemprop="name">write-up</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/qwb-ctf20190526/" itemprop="url" rel="index">
                    <span itemprop="name">qwb_ctf20190526</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JustRe"><a href="#JustRe" class="headerlink" title="JustRe"></a>JustRe</h1><p><a href="\uploads\JustRe.7z">JustRe.7z</a> </p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>程序读入了26位 十六进制数</p>
<p>其中前8为送入eax寄存器</p>
<p>把eax扩展为了16个字节 01234567012345670123456701234567 记作 <strong>input</strong></p>
<p>后两位（假设为ab） 填充为了ababababababababab…..ababab，记作 <strong>ab</strong></p>
<p>从内存中取16个字节，记作 <strong>key1</strong></p>
<p>还从内存取了16个字节，形如00000003000000020000000100000000 记作 <strong>key2</strong></p>
<p>key = (ab + key1)^ (input + key2) 并且将结果存在原来key1的位置</p>
<p>依次循环</p>
<blockquote>
<p>注意key2第二次  key2’ +=  key2 ，而不是直接从内存取</p>
</blockquote>
<p>接下来的循环 循环了八次，是对从0x405058的32个字节进行处理，每次四个字节</p>
<p>同样</p>
<p><strong>input</strong> 01 23 45 67</p>
<p><strong>key</strong> 从内存中取四个字节</p>
<p><strong>ab</strong> 用89位填充的四个字节</p>
<p><strong>esi</strong> 从0x10 开始 一直到0x18</p>
<p>key =  (ab + key) ^ (input + esi) 并且将结果存在key的位置</p>
<p>然后 0x405018 和 0x404148的 0x60个字节进行比较，要相等</p>
<p>事实证明，后面这些运算，对于解出input的帮助并不大，我们只需要解出一组input，并且判断它们是否是四个分块都相等即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dec1 = <span class="number">0x4364162A031410D2EF95C26D80B899BD</span></span><br><span class="line">enc1 = <span class="number">0x405004A100000278EC81F0E483EC8B55</span></span><br><span class="line">key1 = <span class="number">0x00000003000000020000000100000000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FILL</span><span class="params">(a)</span>:</span>  <span class="comment">#用八九位这一个字节去填充为16字节</span></span><br><span class="line">    <span class="keyword">return</span> a * <span class="number">0x01010101010101010101010101010101</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DIVIDE</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        res.append((a &lt;&lt; (<span class="number">32</span> * i) &amp; <span class="number">0xffffffffffffffffffffffffffffffff</span>) &gt;&gt; (<span class="number">32</span> * <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ADD</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    a = DIVIDE(a)</span><br><span class="line">    b = DIVIDE(b)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        res += ((a[i]+b[i]) &amp; <span class="number">0xffffffff</span>) &lt;&lt; (<span class="number">32</span> * (<span class="number">3</span>-i))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CALC</span><span class="params">(dec,enc,key,t)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (ADD(FILL(t),dec) ^ enc) - key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">100</span>):<span class="comment">#枚举第八第九位的所有情况</span></span><br><span class="line">    res = CALC(dec1,enc1,key1,t)</span><br><span class="line">    <span class="keyword">if</span>(inpu &amp; <span class="number">0xffffffff</span> == res &gt;&gt; (<span class="number">3</span> * <span class="number">32</span>)):</span><br><span class="line">        print(hex(CALC(dec1,enc1,key1,t) &gt;&gt; (<span class="number">3</span>*<span class="number">32</span>)),hex(t))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>前十位 1324229810</p>
</blockquote>
<p>用来过验证的passwd：13242298100123456789abcdef</p>
<p>后面这个加密函数是好像藏在data区里面的，看起来应该是一个加密算法，谷歌了几个比较关键的常数，发现是个3des加密</p>
<p><a href="https://www.cnblogs.com/one--way/archive/2016/07/05/5643771.html" target="_blank" rel="noopener">https://www.cnblogs.com/one--way/archive/2016/07/05/5643771.html</a></p>
<p>密钥应该是这个 AFSAFCEDYCXCXACNDFKDCQXC</p>
<p>再配上解密后的密文（实际上只用到了16个字节，剩下的8个字节可要可不要）</p>
<p><strong>注意：大端序，不能直接复制，要先把顺序颠倒一下</strong></p>
<blockquote>
<p>轮子不太完整，修改了一下，以下是main函数中修改过的内容</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">	<span class="keyword">char</span> k[<span class="number">32</span>] = <span class="string">"AFSAFCEDYCXCXACNDFKDCQXC"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> data[<span class="number">128</span>] = &#123;</span><br><span class="line">    	<span class="number">0x50</span>,<span class="number">0x7C</span>,<span class="number">0xA9</span>,<span class="number">0xE6</span>,</span><br><span class="line">    	<span class="number">0x87</span>,<span class="number">0x09</span>,<span class="number">0xCE</span>,<span class="number">0xFA</span>,</span><br><span class="line">		<span class="number">0x20</span>,<span class="number">0xD5</span>,<span class="number">0x0D</span>,<span class="number">0xCF</span>,</span><br><span class="line">		<span class="number">0x90</span>,<span class="number">0xBB</span>,<span class="number">0x97</span>,<span class="number">0x6C</span>,<span class="number">0</span></span><br><span class="line">		&#125;;  <span class="comment">/* 原始明文 */</span></span><br><span class="line">	nlen = <span class="built_in">strlen</span>(data);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.....</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">8</span>) &#123;</span><br><span class="line">        DES_ecb3_encrypt((const_DES_cblock *)(src + i), (DES_cblock *)(out + i), &amp;ks1, &amp;ks2, &amp;ks3, DES_DECRYPT);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"encrypted Hex:"</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%02X"</span> , *(out + i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"encrypted Bin:"</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>, *(out + i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/8b232dcf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/8b232dcf/" class="post-title-link" itemprop="url">rctf_babyre2</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-21 20:29:34 / Modified: 20:51:36" itemprop="dateCreated datePublished" datetime="2019-05-21T20:29:34+08:00">2019-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/" itemprop="url" rel="index">
                    <span itemprop="name">write-up</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/rctf-20190518/" itemprop="url" rel="index">
                    <span itemprop="name">rctf-20190518</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Rctf-babyre2"><a href="#Rctf-babyre2" class="headerlink" title="Rctf_babyre2"></a>Rctf_babyre2</h1><p><a href="\uploads\rctf_babyre2.7z">rctf_babyre2</a></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><h3 id="alarm"><a href="#alarm" class="headerlink" title="alarm"></a>alarm</h3><blockquote>
<p>程序一开头就有一个alarm函数，这会使我们在调试的时候中途退出，直接把call alarm nop掉即可</p>
</blockquote>
<h3 id="sub-55761565891A"><a href="#sub-55761565891A" class="headerlink" title="sub_55761565891A"></a>sub_55761565891A</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_55761565891A</span><span class="params">(<span class="keyword">void</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  print_notice();</span><br><span class="line">  <span class="built_in">memset</span>(a1, <span class="number">0</span>, <span class="number">0x100</span>uLL);</span><br><span class="line">  read(<span class="number">0</span>, a1, <span class="number">0xFF</span>uLL);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)a1);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">7</span> )</span><br><span class="line">      v2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      print_notice();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    print_notice();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="sub-5576156589CC"><a href="#sub-5576156589CC" class="headerlink" title="sub_5576156589CC"></a>sub_5576156589CC</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_5576156589CC</span><span class="params">(<span class="keyword">void</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  print_notice();</span><br><span class="line">  <span class="built_in">memset</span>(a1, <span class="number">0</span>, <span class="number">0x100</span>uLL);</span><br><span class="line">  read(<span class="number">0</span>, a1, <span class="number">0xFF</span>uLL);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)a1);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt;= <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt; <span class="number">7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v4; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( *((_BYTE *)a1 + i) &lt;= <span class="number">9</span> || *((_BYTE *)a1 + i) &gt; <span class="number">99</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          print_notice();</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      print_notice();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    print_notice();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单的读入账户和密码，不赘述</p>
<blockquote>
<p>不赘述就出问题了</p>
<p>读密码的时候你没发现一个奇怪的事情吗？</p>
<p> if ( *((_BYTE *)a1 + i) &lt;= 9 || *((_BYTE *)a1 + i) &gt; 99 )</p>
<p>密码可以不是可见字符</p>
</blockquote>
<h3 id="sub-557615658ACE"><a href="#sub-557615658ACE" class="headerlink" title="sub_557615658ACE"></a>sub_557615658ACE</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">sub_557615658ACE</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+10h] [rbp-40h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+14h] [rbp-3Ch]</span></span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+31h] [rbp-1Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+32h] [rbp-1Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+33h] [rbp-1Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+34h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+35h] [rbp-1Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+36h] [rbp-1Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+37h] [rbp-19h]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+39h] [rbp-17h]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+3Ah] [rbp-16h]</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [rsp+3Bh] [rbp-15h]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+3Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+3Dh] [rbp-13h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+3Eh] [rbp-12h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+3Fh] [rbp-11h]</span></span><br><span class="line">  <span class="keyword">char</span> v24; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v25; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v25 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v8 = <span class="number">-8</span>;</span><br><span class="line">  v9 = <span class="number">-44</span>;</span><br><span class="line">  v10 = <span class="number">-43</span>;</span><br><span class="line">  v11 = <span class="number">-36</span>;</span><br><span class="line">  v12 = <span class="number">-55</span>;</span><br><span class="line">  v13 = <span class="number">-38</span>;</span><br><span class="line">  v14 = <span class="number">-49</span>;</span><br><span class="line">  v15 = <span class="number">-50</span>;</span><br><span class="line">  v16 = <span class="number">-41</span>;</span><br><span class="line">  v17 = <span class="number">-38</span>;</span><br><span class="line">  v18 = <span class="number">-49</span>;</span><br><span class="line">  v19 = <span class="number">-46</span>;</span><br><span class="line">  v20 = <span class="number">-44</span>;</span><br><span class="line">  v21 = <span class="number">-43</span>;</span><br><span class="line">  v22 = <span class="number">-56</span>;</span><br><span class="line">  v23 = <span class="number">-102</span>;</span><br><span class="line">  v24 = <span class="number">-79</span>;</span><br><span class="line">  dest = <span class="number">0L</span>L;</span><br><span class="line">  v7 = <span class="number">0L</span>L;</span><br><span class="line">  v5 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)a1);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &lt;= <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;dest, (<span class="keyword">const</span> <span class="keyword">void</span> *)a1, (<span class="keyword">signed</span> <span class="keyword">int</span>)v5);<span class="comment">// 复制内存</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; <span class="number">16</span> - (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &gt; i; ++i )</span><br><span class="line">      *((_BYTE *)&amp;dest + i + (<span class="keyword">signed</span> <span class="keyword">int</span>)v5) = i + <span class="number">1</span>;<span class="comment">// 对于没有满16位的account 自动补全16位(补全一个从0开始的递增序列)</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">    dest = *(_QWORD *)a1;</span><br><span class="line">    v7 = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_55761565981E(&amp;v8, <span class="number">17</span>, (__int64)&amp;dest, <span class="number">16</span>, (<span class="keyword">int</span> *)a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">sub_55761565981E</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">int</span> a2, __int64 a1, <span class="keyword">int</span> a4, <span class="keyword">int</span> *a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  __int64 acc; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v8; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  acc = a1;</span><br><span class="line">  v6 = a5;</span><br><span class="line">  dest = <span class="number">0L</span>L;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( buf )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a2 &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( a4 == <span class="number">16</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( a5 )</span><br><span class="line">          &#123;</span><br><span class="line">            *a5 = <span class="number">0</span>;</span><br><span class="line">            v9 = <span class="number">4</span> * (a2 / <span class="number">4</span> + <span class="number">1</span>);</span><br><span class="line">            dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(v9 + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> ( dest )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">memcpy</span>(dest, buf, a2);</span><br><span class="line">              <span class="built_in">memset</span>(&amp;dest[a2], <span class="number">4</span> - a2 % <span class="number">4</span>, <span class="number">4</span> - a2 % <span class="number">4</span>);<span class="comment">// 填充了3</span></span><br><span class="line">              dest[v9] = <span class="number">0</span>;</span><br><span class="line">              xtea((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)dest, v9 / <span class="number">4</span>, acc);<span class="comment">// 这里是执行了加密的过程,account作为密钥</span></span><br><span class="line">              *v6 = v9;</span><br><span class="line">              v8 = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dest )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span>(dest);</span><br><span class="line">      dest = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v6 )</span><br><span class="line">      *v6 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单来说就是利用xtea算法，将buf（上面的数组）加密了，密钥是账户名</p>
<h3 id="sub-557615658C02"><a href="#sub-557615658C02" class="headerlink" title="sub_557615658C02"></a>sub_557615658C02</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_557615658C02</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-81Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+18h] [rbp-818h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// [rsp+18h] [rbp-818h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-814h]</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">2048</span>]; <span class="comment">// [rsp+20h] [rbp-810h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+820h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+828h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  print_notice();</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x400</span>uLL);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(buf);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &amp; <span class="number">1</span> || v3 &gt; <span class="number">1024</span> )                    <span class="comment">// 长度不超过1024,且必须为偶数</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    print_notice();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v3; ++i )                  <span class="comment">// 检测输入是否合规</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (buf[i] &lt;= <span class="number">47</span> || buf[i] &gt; <span class="number">57</span>) &amp;&amp; (buf[i] &lt;= <span class="number">96</span> || buf[i] &gt; <span class="number">102</span>) &amp;&amp; (buf[i] &lt;= <span class="number">64</span> || buf[i] &gt; <span class="number">70</span>) )<span class="comment">// 只准输入数字，大小写的字母a~f</span></span><br><span class="line">      &#123;</span><br><span class="line">        print_notice();</span><br><span class="line">        v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v2 )                                   <span class="comment">// 如果输入合规</span></span><br><span class="line">      v4 = sub_5576156587C6(buf, v3, (_QWORD *)a1);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>读入了偶数个字节的数据，并且长度不超过1024，数据只能在0<del>9 a</del>f A~F的范围</p>
<h3 id="sub-557615658DD6"><a href="#sub-557615658DD6" class="headerlink" title="sub_557615658DD6"></a>sub_557615658DD6</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">_BYTE *__<span class="function">fastcall <span class="title">sub_557615658DD6</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *passwd, __int64 data, <span class="keyword">int</span> chunk, _DWORD *a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v5; <span class="comment">// [rsp+0h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+Ch] [rbp-44h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v7; <span class="comment">// [rsp+2Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v8; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+34h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+3Ch] [rbp-14h]</span></span><br><span class="line">  _BYTE *ptr; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v6 = chunk;</span><br><span class="line">  v5 = a4;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  ptr = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( data )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( chunk &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( passwd )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = <span class="built_in">strlen</span>(passwd);</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt; <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          ptr = <span class="built_in">malloc</span>(v10 + <span class="number">1</span>);</span><br><span class="line">          <span class="keyword">if</span> ( ptr )</span><br><span class="line">          &#123;</span><br><span class="line">            ptr[v10] = <span class="number">0</span>;</span><br><span class="line">            v8 = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v10; ++i )</span><br><span class="line">            &#123;</span><br><span class="line">              v11 = passwd[i] - (passwd[i] % <span class="number">10</span> + passwd[i] / <span class="number">10</span>);<span class="comment">// 由passwd生成了一个偏移地址</span></span><br><span class="line">              <span class="keyword">if</span> ( v11 &gt;= v6 )</span><br><span class="line">              &#123;</span><br><span class="line">                v8 = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              ptr[i] = *(_BYTE *)(v11 + data);  <span class="comment">// ptr[i]就等于这个偏移地址上面的数据</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v8 )                           <span class="comment">// 若正常退出</span></span><br><span class="line">            &#123;</span><br><span class="line">              *v5 = v10;</span><br><span class="line">              v7 = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v7 &amp;&amp; ptr )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    ptr = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ptr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用passwd可以算出来一个偏移，对应着data中的数据，生成了一个ptr数组</p>
<h3 id="sub-557615658FB0"><a href="#sub-557615658FB0" class="headerlink" title="sub_557615658FB0"></a>sub_557615658FB0</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; passwd_len; ++j )</span><br><span class="line">    *((_BYTE *)&amp;dest + j) ^= <span class="number">0xCC</span>u;             <span class="comment">// ptr进行异或0xcc</span></span><br><span class="line">  ::ptr = sub_5576156599B9(v6, v7, (__int64)&amp;dest, <span class="number">16</span>, &amp;dword_55761585B058);</span><br></pre></td></tr></table></figure>

<p>sub_5576156599B9:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">xtea((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)dest, buf_len / <span class="number">-4</span>, v7);<span class="comment">// 这里执行解密的过程，解密encrypted，密钥为ptr_xor</span></span><br></pre></td></tr></table></figure>

<h3 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h3><blockquote>
<p> xtea(xtea(buf, accout, ENCRYPT) ,f(data,passwd) , DECRYPT)</p>
</blockquote>
<blockquote>
<p>f(data, passwd) == accout</p>
</blockquote>
<p>passwd到data是一个很简单的映射，映射完之后要异或一个0xcc，异或结果应该刚好等于account</p>
<h2 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h2><p>script from dalao</p>
<p><a href="https://balsn.tw/ctf_writeup/20190518-rctf2019/#babyre2" target="_blank" rel="noopener">https://balsn.tw/ctf_writeup/20190518-rctf2019/#babyre2</a></p>
<p>我自己还没用过pwntools。。。没想到要直接给程序传入非可见字符，所以就借用了一下国外大佬的脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">"139.180.215.222"</span>, <span class="number">20000</span>)</span><br><span class="line"><span class="keyword">print</span> r.recvuntil(<span class="string">"account"</span>)</span><br><span class="line">r.send(<span class="string">"a"</span>*<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> r.recvuntil(<span class="string">"password"</span>)</span><br><span class="line">r.send(<span class="string">"\x10"</span>*<span class="number">16</span>)</span><br><span class="line">r.recvuntil(<span class="string">"data"</span>)</span><br><span class="line">r.send(<span class="string">"010203040506070809ad0b0c0d0e0f"</span>) <span class="comment">#ad=61^cc</span></span><br><span class="line">r.shutdown(<span class="string">"send"</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/122a7c75/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/122a7c75/" class="post-title-link" itemprop="url">rctf_babyre1</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-21 00:49:39 / Modified: 20:51:31" itemprop="dateCreated datePublished" datetime="2019-05-21T00:49:39+08:00">2019-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/" itemprop="url" rel="index">
                    <span itemprop="name">write-up</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/rctf-20190518/" itemprop="url" rel="index">
                    <span itemprop="name">rctf-20190518</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="RCTF-babyre1"><a href="#RCTF-babyre1" class="headerlink" title="RCTF_babyre1"></a>RCTF_babyre1</h1><p><a href="\uploads\rctf_babyre1.7z">rctf_babyre1</a></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>以下是与输入相关的指令</p>
<h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 *in; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// rbx</span></span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [rsp+4h] [rbp-124h]</span></span><br><span class="line">  <span class="keyword">void</span> *ptr; <span class="comment">// [rsp+8h] [rbp-120h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 str; <span class="comment">// [rsp+10h] [rbp-118h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+118h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0L</span>L);</span><br><span class="line">  ptr = <span class="number">0L</span>L;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;str, <span class="number">0</span>, <span class="number">0x100</span>uLL);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Input right flag you can got 'Bingo!' :"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%31s"</span>, &amp;str);                 <span class="comment">// 输入为16位</span></span><br><span class="line">  in = &amp;str;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *(_DWORD *)in;</span><br><span class="line">    in = (<span class="keyword">unsigned</span> __int64 *)((<span class="keyword">char</span> *)in + <span class="number">4</span>);</span><br><span class="line">    v5 = ~v4 &amp; (v4 - <span class="number">0x1010101</span>) &amp; <span class="number">0x80808080</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( !v5 );</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">unsigned</span> __int16)~(_WORD)v4 &amp; (<span class="keyword">unsigned</span> __int16)(v4 - <span class="number">0x101</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">    v5 &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">unsigned</span> __int16)~(_WORD)v4 &amp; (<span class="keyword">unsigned</span> __int16)(v4 - <span class="number">0x101</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">    in = (<span class="keyword">unsigned</span> __int64 *)((<span class="keyword">char</span> *)in + <span class="number">2</span>);</span><br><span class="line">  v6 = (<span class="keyword">char</span> *)in - __CFADD__((_BYTE)v5, (_BYTE)v5) - <span class="number">3</span> - (<span class="keyword">char</span> *)&amp;str;</span><br><span class="line">  <span class="keyword">if</span> ( v6 &gt; <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"input is too long!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v6 == <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = change_into_number((<span class="keyword">unsigned</span> __int64)&amp;str, <span class="number">16</span>, &amp;ptr);<span class="comment">// 这个程序就是把输入的内容（十六进制）转换成了程序可读的数字</span></span><br><span class="line">    <span class="keyword">if</span> ( v7</span><br><span class="line">      &amp;&amp; (v8 = xtea_keychanged(ptr, v7, (__int64)&amp;unk_55883B7B0010, <span class="number">16</span>, &amp;v12), (v9 = (<span class="keyword">char</span> *)v8) != <span class="number">0L</span>L)</span><br><span class="line">      &amp;&amp; v12 &gt; <span class="number">0</span></span><br><span class="line">      &amp;&amp; (<span class="keyword">unsigned</span> __int16)crc16((__int64)v8, v12) == <span class="number">0x69E2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0L</span>L; v12 &gt; (<span class="keyword">signed</span> <span class="keyword">int</span>)i; ++i )</span><br><span class="line">        v9[i] ^= <span class="number">0x17</span>u;</span><br><span class="line">      <span class="built_in">puts</span>(v9);</span><br><span class="line">      <span class="keyword">if</span> ( ptr )</span><br><span class="line">        <span class="built_in">free</span>(ptr);</span><br><span class="line">      <span class="built_in">free</span>(v9);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"input flag is wrong!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"input is too short!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到输入后的字符串进行了一大堆看不懂的操作，但是能推测出来输入的长度为16位</p>
<p>用ida调试可知，change_into_number这个函数把输入的字符串进行了转换</p>
<p>完成了16进制字符串 -&gt; 16进制整数的过程</p>
<h3 id="xtea-keychanged中的一个子函数"><a href="#xtea-keychanged中的一个子函数" class="headerlink" title="xtea_keychanged中的一个子函数"></a>xtea_keychanged中的一个子函数</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_55883B5AECE0</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">signed</span> <span class="keyword">int</span> a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// er12</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// r13</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// er14</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v10; <span class="comment">// er15</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v11; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// er8</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v17; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v25; <span class="comment">// er11</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// r13</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// er14</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v28; <span class="comment">// er12</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v29; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v32; <span class="comment">// er9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v33; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v35; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v36; <span class="comment">// dl</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v38; <span class="comment">// er15</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v40; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">int</span> v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">bool</span> v42; <span class="comment">// zf</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v43; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v45; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line"></span><br><span class="line">  v3 = a3;</span><br><span class="line">  v4 = a2;</span><br><span class="line">  v5 = *a1;</span><br><span class="line">  v43 = a2;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = a2 - <span class="number">1</span>;</span><br><span class="line">    v7 = &amp;a1[a2 - <span class="number">1</span>];</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    v9 = *v7;</span><br><span class="line">    v10 = ((a2 - <span class="number">4</span>) &amp; <span class="number">0xFFFFFFFE</span>) + <span class="number">2</span>;</span><br><span class="line">    v45 = <span class="number">0x9E3779B9</span> * (<span class="number">52</span> / a2) - <span class="number">0x4AB325AA</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 -= <span class="number">0x61C88647</span>;</span><br><span class="line">      v11 = v8 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v43 &lt;= <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v12 = *a1;</span><br><span class="line">        v13 = a1;</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v15 = v13[<span class="number">1</span>];</span><br><span class="line">          v13 += <span class="number">2</span>;</span><br><span class="line">          v16 = (v9 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v14 ^ (<span class="keyword">unsigned</span> __int8)v11) &amp; <span class="number">3</span>))) + (v15 ^ v8);</span><br><span class="line">          v17 = v14 + <span class="number">1</span>;</span><br><span class="line">          v14 += <span class="number">2</span>;</span><br><span class="line">          v18 = v12 + ((((v9 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v15) + ((v15 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v9)) ^ v16);</span><br><span class="line">          v12 = *v13;</span><br><span class="line">          *(v13 - <span class="number">2</span>) = v18;</span><br><span class="line">          v9 = v15</span><br><span class="line">             + (((<span class="number">4</span> * v12 ^ (v18 &gt;&gt; <span class="number">5</span>)) + (<span class="number">16</span> * v18 ^ (v12 &gt;&gt; <span class="number">3</span>))) ^ ((v12 ^ v8)</span><br><span class="line">                                                                    + (v18 ^ *(_DWORD *)(v3</span><br><span class="line">                                                                                       + <span class="number">4L</span>L</span><br><span class="line">                                                                                       * (((<span class="keyword">unsigned</span> __int8)v11 ^ v17) &amp; <span class="number">3</span>)))));</span><br><span class="line">          *(v13 - <span class="number">1</span>) = v9;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v10 != v14 );</span><br><span class="line">      &#125;</span><br><span class="line">      v19 = &amp;a1[v14];</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v20 = v19[<span class="number">1</span>];</span><br><span class="line">        v21 = v11 ^ v14++;</span><br><span class="line">        ++v19;</span><br><span class="line">        v22 = *(v19 - <span class="number">1</span>)</span><br><span class="line">            + (((v9 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (v21 &amp; <span class="number">3</span>))) + (v20 ^ v8)) ^ ((<span class="number">16</span> * v9 ^ (v20 &gt;&gt; <span class="number">3</span>)) + ((v9 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v20)));</span><br><span class="line">        *(v19 - <span class="number">1</span>) = v22;</span><br><span class="line">        v9 = v22;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v6 &gt; v14 );</span><br><span class="line">      v9 = *v7</span><br><span class="line">         + (((v22 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v6 ^ (<span class="keyword">unsigned</span> __int8)v11) &amp; <span class="number">3</span>))) + (*a1 ^ v8)) ^ ((<span class="number">4</span> * *a1 ^ (v22 &gt;&gt; <span class="number">5</span>)) + (<span class="number">16</span> * v22 ^ ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*a1 &gt;&gt; <span class="number">3</span>))));</span><br><span class="line">      *v7 = v9;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v8 != v45 );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">1L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &lt; <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v24 = -a2;</span><br><span class="line">    v25 = <span class="number">-1640531527</span> * (<span class="number">52</span> / v24 + <span class="number">6</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v25 )</span><br><span class="line">    &#123;</span><br><span class="line">      v26 = &amp;a1[v24 - <span class="number">1</span>];</span><br><span class="line">      v27 = ~v4;</span><br><span class="line">      v44 = &amp;a1[~v4];</span><br><span class="line">      v28 = ~v4 - <span class="number">2</span> - ((~v4 - <span class="number">3</span>) &amp; <span class="number">0xFFFFFFFE</span>);</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v29 = v25 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v27 &lt;= <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v31 = v27;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v30 = v44;</span><br><span class="line">          v31 = v27;</span><br><span class="line">          v32 = *v44;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            v33 = *(v30 - <span class="number">1</span>);</span><br><span class="line">            v30 -= <span class="number">2</span>;</span><br><span class="line">            v34 = v32;</span><br><span class="line">            v32 = *v30;</span><br><span class="line">            v35 = ((v5 ^ v25) + (v33 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v31 ^ (<span class="keyword">unsigned</span> __int8)v29) &amp; <span class="number">3</span>)))) ^ ((<span class="number">4</span> * v5 ^ (v33 &gt;&gt; <span class="number">5</span>)) + ((v5 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v33));</span><br><span class="line">            v36 = v31 - <span class="number">1</span>;</span><br><span class="line">            v31 -= <span class="number">2</span>;</span><br><span class="line">            v37 = v34 - v35;</span><br><span class="line">            v38 = *v30;</span><br><span class="line">            v30[<span class="number">2</span>] = v37;</span><br><span class="line">            v5 = v33</span><br><span class="line">               - (((<span class="number">16</span> * v38 ^ (v37 &gt;&gt; <span class="number">3</span>)) + ((v32 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v37)) ^ ((v32 ^ *(_DWORD *)(v3</span><br><span class="line">                                                                                         + <span class="number">4L</span>L</span><br><span class="line">                                                                                         * (((<span class="keyword">unsigned</span> __int8)v29 ^ v36) &amp; <span class="number">3</span>)))</span><br><span class="line">                                                                      + (v25 ^ v37)));</span><br><span class="line">            v30[<span class="number">1</span>] = v5;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( v28 != v31 );</span><br><span class="line">        &#125;</span><br><span class="line">        v39 = &amp;a1[v31];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v40 = *(v39 - <span class="number">1</span>);</span><br><span class="line">          --v39;</span><br><span class="line">          v5 = v39[<span class="number">1</span>]</span><br><span class="line">             - (((v5 ^ v25) + (v40 ^ *(_DWORD *)(v3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v29 ^ (<span class="keyword">unsigned</span> __int8)v31) &amp; <span class="number">3</span>)))) ^ (((v5 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v40) + ((v40 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v5)));</span><br><span class="line">          v39[<span class="number">1</span>] = v5;</span><br><span class="line">          --v31;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v31 );</span><br><span class="line">        v41 = *a1</span><br><span class="line">            - (((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*v26 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v5) + (<span class="number">16</span> * *v26 ^ (v5 &gt;&gt; <span class="number">3</span>))) ^ ((*(_DWORD *)(v3 + <span class="number">4L</span>L * (v29 &amp; <span class="number">3</span>)) ^ *v26)</span><br><span class="line">                                                                                 + (v25 ^ v5)));</span><br><span class="line">        v42 = v25 == <span class="number">-1640531527</span>;</span><br><span class="line">        v25 += <span class="number">1640531527</span>;</span><br><span class="line">        v5 = v41;</span><br><span class="line">        *a1 = v41;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( !v42 );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由0x9E3779B9可知，这是一个xtea加密（解密）算法</p>
<p>然后加解密所使用的常数有所改变，是内存中的16字节的数组</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">xtea(v8, -(v10 &gt;&gt; <span class="number">2</span>), constant)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个 -(v10 &gt;&gt; 2)明显是一个负数，而xtea函数为负时，就是解密的过程</p>
</blockquote>
<blockquote>
<p>在调试时xtea_keychanged这个函数执行完后就直接报wrong</p>
</blockquote>
<p>经高人指点，这个是xtea解密失败，程序判断这个密码解不出来，就直接报错了</p>
<h3 id="xtea-keychanged"><a href="#xtea-keychanged" class="headerlink" title="xtea_keychanged"></a>xtea_keychanged</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> *__<span class="function">fastcall <span class="title">xtea_keychanged</span><span class="params">(<span class="keyword">void</span> *src, <span class="keyword">int</span> const_8, __int64 a3, <span class="keyword">int</span> a4, <span class="keyword">int</span> *a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// er12</span></span><br><span class="line">  __int64 constant; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">int</span> *<span class="built_in">string</span>; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// er12</span></span><br><span class="line"></span><br><span class="line">  v5 = a5;</span><br><span class="line">  <span class="keyword">if</span> ( !src || (v6 = const_8, const_8 &lt;= <span class="number">0</span>) || (constant = a3) == <span class="number">0</span> || a4 != <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !a5 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">string</span> = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( a5 )</span><br><span class="line">  &#123;</span><br><span class="line">    *a5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !(const_8 &amp; <span class="number">3</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(const_8 + <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">string</span> = v9;</span><br><span class="line">      <span class="keyword">if</span> ( v9 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(v9, src, const_8);               <span class="comment">// v9 存储了输入的16进制数</span></span><br><span class="line">        v10 = const_8 + <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">          v10 = v6;</span><br><span class="line">        xtea(<span class="built_in">string</span>, -(v10 &gt;&gt; <span class="number">2</span>), constant);    <span class="comment">// xtea对输入的字符串进行解密</span></span><br><span class="line">        v11 = *((<span class="keyword">unsigned</span> __int8 *)<span class="built_in">string</span> + v6 - <span class="number">1</span>);<span class="comment">// 取第八个字符</span></span><br><span class="line">        *((_BYTE *)<span class="built_in">string</span> + v6) = <span class="number">0</span>;</span><br><span class="line">        *v5 = v6;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; v11 &amp;&amp; v11 &lt;= <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v13 = v6 - v11;                       <span class="comment">// 8 - v11</span></span><br><span class="line">          *v5 = v13;</span><br><span class="line">          *((_BYTE *)<span class="built_in">string</span> + v13) = <span class="number">0</span>;         <span class="comment">// 把某一位置零了</span></span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">string</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(<span class="built_in">string</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *v5 = <span class="number">0</span>;</span><br><span class="line">LABEL_14:</span><br><span class="line">    <span class="built_in">string</span> = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">*((_BYTE *)<span class="built_in">string</span> + v13) = <span class="number">0</span>;         <span class="comment">// 把某一位置零了</span></span><br></pre></td></tr></table></figure>

<p>这句话很关键，把某一位截断了，而这一位只能是倒数第二位</p>
<h3 id="crc16"><a href="#crc16" class="headerlink" title="crc16"></a>crc16</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_55883B5AF3D0</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// r12</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  __int16 v4; <span class="comment">// ax</span></span><br><span class="line">  __int16 v5; <span class="comment">// ax</span></span><br><span class="line">  __int16 v6; <span class="comment">// dx</span></span><br><span class="line">  __int16 v7; <span class="comment">// ax</span></span><br><span class="line">  __int16 v8; <span class="comment">// dx</span></span><br><span class="line">  __int16 v9; <span class="comment">// ax</span></span><br><span class="line">  __int16 v10; <span class="comment">// dx</span></span><br><span class="line">  __int16 v11; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v13; <span class="comment">// [rsp+5h] [rbp-23h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v14; <span class="comment">// [rsp+6h] [rbp-22h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+8h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = a1;</span><br><span class="line">    v3 = a1 + (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(a2 - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v13 = *(_BYTE *)(++v2 - <span class="number">1</span>);</span><br><span class="line">        sub_55883B5AF270(&amp;v13, &amp;v13);</span><br><span class="line">        v4 = v14 ^ (v13 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">if</span> ( ((v14 ^ (v13 &lt;&lt; <span class="number">8</span>)) &amp; <span class="number">0x8000</span>u) != <span class="number">0</span> )</span><br><span class="line">          v5 = <span class="number">2</span> * v4 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          v5 = <span class="number">2</span> * v4;</span><br><span class="line">        v6 = <span class="number">2</span> * v5 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v5 &gt;= <span class="number">0</span> )</span><br><span class="line">          v6 = <span class="number">2</span> * v5;</span><br><span class="line">        v7 = <span class="number">2</span> * v6 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">          v7 = <span class="number">2</span> * v6;</span><br><span class="line">        v8 = <span class="number">2</span> * v7 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v7 &gt;= <span class="number">0</span> )</span><br><span class="line">          v8 = <span class="number">2</span> * v7;</span><br><span class="line">        v9 = <span class="number">2</span> * v8 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v8 &gt;= <span class="number">0</span> )</span><br><span class="line">          v9 = <span class="number">2</span> * v8;</span><br><span class="line">        v10 = <span class="number">2</span> * v9 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> )</span><br><span class="line">          v10 = <span class="number">2</span> * v9;</span><br><span class="line">        v11 = <span class="number">2</span> * v10 ^ <span class="number">0x1021</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= <span class="number">0</span> )</span><br><span class="line">          v11 = <span class="number">2</span> * v10;</span><br><span class="line">        <span class="keyword">if</span> ( v11 &lt; <span class="number">0</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v14 = <span class="number">2</span> * v11;</span><br><span class="line">        <span class="keyword">if</span> ( v2 == v3 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_19;</span><br><span class="line">      &#125;</span><br><span class="line">      v14 = <span class="number">2</span> * v11 ^ <span class="number">0x1021</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v2 != v3 );</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_19:</span><br><span class="line">  sub_55883B5AF2D0(&amp;v14, &amp;v14);</span><br><span class="line">  <span class="keyword">return</span> v14;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也是通过0x1021可知，这是一个crc16校验，校验码为0x1021</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 == v3 )</span><br><span class="line">     <span class="keyword">goto</span> LABEL_19;</span><br></pre></td></tr></table></figure>

<p>由这句话可知，v2会从起始字节一直遍历到v3处，那么a2就要构造得刚好把这些值覆盖，可知a2=6，所以解密后的那个数组的最后一个字节就是2</p>
<p>调试tips:</p>
<blockquote>
<p> 有效的加密字符串 4290cd6dc6ae54cc</p>
<p>解密后得0123456789abcd02</p>
</blockquote>
<h3 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h3><ol>
<li>程序读入16位的十六进制数，并转化为8字节</li>
<li>将数据进行xtea解密</li>
</ol>
<blockquote>
<p>同时这个自带加密函数，只需要把输入的参数取反，就是逆过程了</p>
</blockquote>
<ol>
<li>将解密后的数据进行crc16校验（校验码为0x1021），得到结果<strong>0x69E2</strong></li>
<li>这个解密后的数组去异或0x17能得到”Bingo!” 字符串</li>
</ol>
<h2 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc16</span><span class="params">(data: bytes, poly=<span class="number">0x1021</span>)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    CRC-16-CCITT Algorithm</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    data = bytearray(data)</span><br><span class="line">    crc = <span class="number">0xFFFF</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        cur_byte = <span class="number">0xFF</span> &amp; b</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> (crc &amp; <span class="number">0x0001</span>) ^ (cur_byte &amp; <span class="number">0x0001</span>):</span><br><span class="line">                crc = (crc &gt;&gt; <span class="number">1</span>) ^ poly</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                crc &gt;&gt;= <span class="number">1</span></span><br><span class="line">            cur_byte &gt;&gt;= <span class="number">1</span></span><br><span class="line">    crc = (~crc &amp; <span class="number">0xFFFF</span>)</span><br><span class="line">    crc = (crc &lt;&lt; <span class="number">8</span>) | ((crc &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> crc &amp; <span class="number">0xFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc = <span class="string">"Bingo!"</span></span><br><span class="line">dec = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    dec.append(hex(ord(i) ^ <span class="number">0x17</span>))</span><br><span class="line">dec.append(hex(<span class="number">6</span>))</span><br><span class="line">dec.append(hex(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">print(dec)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>557e797078360602</p>
</blockquote>
<p>然后再拿这个字符串去加密一遍，就得到flag了</p>
<blockquote>
<p>rctf{2a2e71aab6168fb6}</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>] Accepting connection <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.133</span><span class="number">.1</span>...</span><br><span class="line">Input right flag you can got <span class="string">'Bingo!'</span> :<span class="number">2</span>a2e71aab6168fb6</span><br><span class="line"></span><br><span class="line">    Bingo!</span><br></pre></td></tr></table></figure>

<blockquote>
<p>后续：据说倒数第二字节是个padding</p>
<p>有空再填坑  <a href="https://blog.csdn.net/shift_wwx/article/details/84256774" target="_blank" rel="noopener">https://blog.csdn.net/shift_wwx/article/details/84256774</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/74b676c7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/74b676c7/" class="post-title-link" itemprop="url">ccsp2019西南赛区</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-19 00:29:53 / Modified: 01:17:17" itemprop="dateCreated datePublished" datetime="2019-05-19T00:29:53+08:00">2019-05-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/牢骚/" itemprop="url" rel="index">
                    <span itemprop="name">牢骚</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CCSP2019"><a href="#CCSP2019" class="headerlink" title="CCSP2019"></a>CCSP2019</h1><blockquote>
<p> 有幸通过了CCF CSP  认证，获得了参加CCSP西南赛区比赛的资格</p>
</blockquote>
<p><strong>来到川大（江安校区）</strong></p>
<p>这个校区管理非常严格，进门之前甚至需要出示身份证和准考证( x</p>
<p>校园中一片宁静，可能是因为星期六的原因，并没有太多人愿意在这个搭好的天气出来走动走动，偶尔看见一两对情侣唧唧我我，酸死我了</p>
<p><img src="https://i.loli.net/2019/05/19/5ce039812509636998.jpg" alt="MVIMG_20190518_165030.jpg"></p>
<p>人文气息极其浓厚</p>
<p><img src="https://i.loli.net/2019/05/19/5ce03985947f538834.jpg" alt="MVIMG_20190518_162435.jpg"></p>
<p>这个比赛并不是很出名，整个教学楼就只看到两个指示牌，这是其中一个（</p>
<p><img src="https://i.loli.net/2019/05/19/5ce03984b835c99805.jpg" alt="MVIMG_20190518_080614.jpg"></p>
<p>CCSP分区赛是第一次在川大举办的，看出来主办方对于应急事件的处理方法还不够了解，试机过程中状况百出</p>
<p>8:30上机调试，没有提供windows的IDE，仅仅有一个linux虚拟机，配上里面“丰富”的IDE，不过我并不觉得这是一个好办法，因为川大的电脑实在是太垃圾了。。虚拟机真的是带不动啊</p>
<p>幸好我带了U盘，装上了Dev-Cpp</p>
<p>经过无数次重启，好不容易进去了比赛界面</p>
<p>OJ是清华大学提供的，这个非常好</p>
<p><img src="https://i.loli.net/2019/05/19/5ce039821f3f850433.jpg" alt="MVIMG_20190518_092009.jpg"></p>
<p>比赛期间还算进行得很顺利，不过嘛，菜是原罪</p>
<p>第一题是图论题，并不是什么高大上的题目，题目叙述非常简单，就是靠自己爆搜，剪枝吧</p>
<p>第二题模拟题，模拟raid5阵列恢复数据的过程</p>
<p>第三题是一道看不懂的与c++的类有关的题目，，，但是题目给的样例程序，交上去居然有分</p>
<p>中午12:30有午餐，是德克士的汉堡跟鸡腿，主办方在给选手提供良好比赛环境上还是下了很大功夫的</p>
<p>图片：颁奖现场</p>
<p><img src="https://i.loli.net/2019/05/19/5ce039814c74597275.jpg" alt="MVIMG_20190518_153959.jpg"></p>
<blockquote>
<p>水了个铜奖</p>
</blockquote>
<p>奖励是罗技鼠标一个</p>
<p><img src="https://i.loli.net/2019/05/19/5ce03982d7ed266471.jpg" alt="IMG_20190518_233712.jpg"></p>
<p>总结：这次川大之行非常愉快，一方面是见了见老同学聊了聊往事，另一方面我看到了川大在准备比赛上的用心和负责，虽然自己的水平还不够继续参加总决赛，不过这次区域赛无疑是一个很好的锻炼，期待以后的表现</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mrh1s.top/posts/caa72719/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mrh929">
      <meta itemprop="description" content="Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mrh929's home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/posts/caa72719/" class="post-title-link" itemprop="url">single</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-14 13:44:02" itemprop="dateCreated datePublished" datetime="2019-05-14T13:44:02+08:00">2019-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-21 15:55:13" itemprop="dateModified" datetime="2019-05-21T15:55:13+08:00">2019-05-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/" itemprop="url" rel="index">
                    <span itemprop="name">write-up</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-up/cgctf/" itemprop="url" rel="index">
                    <span itemprop="name">cgctf</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="single"><a href="#single" class="headerlink" title="single"></a>single</h1><p><a href="\uploads\single.7z">single</a></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><blockquote>
<p> 经观察 发现a1是一个矩阵</p>
</blockquote>
<h3 id="sub-400833"><a href="#sub-400833" class="headerlink" title="sub_400833"></a>sub_400833</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">sub_400833</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> k; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">24</span>]; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      ++s[*(<span class="keyword">unsigned</span> __int8 *)(<span class="number">9</span> * i + j + a1)];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">1</span>; k &lt;= <span class="number">9</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[k] != <span class="number">1</span> )</span><br><span class="line">        sub_4006F6();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将a1矩阵的<strong>每一行</strong>所指向的地址加1  最后s[1] - s[9] 全部等于1</p>
<p>​    </p>
<h3 id="sub-4008FE"><a href="#sub-4008FE" class="headerlink" title="sub_4008FE"></a>sub_4008FE</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">sub_4008FE</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> k; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">24</span>]; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      ++s[*(<span class="keyword">unsigned</span> __int8 *)(<span class="number">9</span> * j + i + a1)];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">1</span>; k &lt;= <span class="number">9</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[k] != <span class="number">1</span> )</span><br><span class="line">        sub_4006F6();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    将a1矩阵的<strong>每一列</strong>所指向的地址加1  最后s[1] - s[9] 全部等于1</p>
<blockquote>
<p>其实做完这一步的时候我就反应出来这道题可能是一个数独了，并且验证最后一个函数的功能，发现确实是一个数独</p>
</blockquote>
<h3 id="sub-4009C9"><a href="#sub-4009C9" class="headerlink" title="sub_4009C9"></a>sub_4009C9</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">sub_4009C9</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> l; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp+24h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [rsp+28h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v7; <span class="comment">// [rsp+2Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">24</span>]; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = <span class="number">3</span>;</span><br><span class="line">  v7 = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">    <span class="keyword">for</span> ( j = v6 - <span class="number">3</span>; j &lt; v6; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = v7 - <span class="number">3</span>; k &lt; v7; ++k )</span><br><span class="line">        ++s[*(<span class="keyword">unsigned</span> __int8 *)(<span class="number">9</span> * j + k + a1)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( l = <span class="number">1</span>; l &lt;= <span class="number">9</span>; ++l )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[l] != <span class="number">1</span> )</span><br><span class="line">        sub_4006F6();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v7 == <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = <span class="number">3</span>;</span><br><span class="line">      v6 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    将a1矩阵分为<strong>九个正方形的小块</strong>  最后s[1] - s[9] 全部等于1</p>
<h2 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h2><blockquote>
<p>程序先读入一个81位长的字符串</p>
<p>并且通过c -= ‘0’ 来转化为数字</p>
</blockquote>
<p>如果数独的某个位置上面已经有数的话，就必须输入0</p>
<h4 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">addr = <span class="number">0x602080</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">81</span>):</span><br><span class="line">    <span class="keyword">print</span> Byte(addr+i),<span class="string">","</span>,</span><br><span class="line">    <span class="keyword">if</span>((i+<span class="number">1</span>) % <span class="number">9</span> == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">""</span></span><br></pre></td></tr></table></figure>

<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span> , <span class="number">3</span> , <span class="number">0</span> , <span class="number">6</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">6</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">3</span> , <span class="number">2</span> , <span class="number">4</span> , <span class="number">9</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">9</span> , <span class="number">0</span> , <span class="number">1</span> , <span class="number">0</span> , <span class="number">7</span> , <span class="number">0</span> , <span class="number">6</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">7</span> , <span class="number">4</span> , <span class="number">6</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">1</span> , <span class="number">8</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">6</span> , <span class="number">3</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">1</span> , <span class="number">4</span> , <span class="number">7</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">8</span> , <span class="number">0</span> , <span class="number">9</span> , <span class="number">0</span> , <span class="number">4</span> , <span class="number">0</span> , <span class="number">7</span> , <span class="number">0</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">7</span> , <span class="number">4</span> , <span class="number">2</span> , <span class="number">1</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">6</span> , </span><br><span class="line"><span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , <span class="number">3</span> , <span class="number">0</span> , <span class="number">1</span> , <span class="number">0</span> ,</span><br></pre></td></tr></table></figure>

<h4 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h4><p><a href="http://www.llang.net/sudoku/calsudoku.html" target="_blank" rel="noopener">http://www.llang.net/sudoku/calsudoku.html</a> 求解即可</p>
<p>401095728057800001802040305000321589500479002923586000105060203300008950269750804</p>
<p>加个flag</p>
<blockquote>
<p>flag{401095728057800001802040305000321589500479002923586000105060203300008950269750804}</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">mrh929</p>
  <div class="site-description" itemprop="description">Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mrh929</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
